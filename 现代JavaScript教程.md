##### ä¹¦æœ¬ç±»å‹ï¼šç”µå­ä¹¦

##### ä¹¦æœ¬é“¾æ¥ï¼šhttps://zh.javascript.info

##### è¿›åŒ–å²ï¼š

LiveScript ->JavaScript and ECMAScript è§„èŒƒ

##### æµè§ˆå™¨ä¸­çš„ JavaScript èƒ½åšä»€ä¹ˆï¼Ÿ

- åœ¨ç½‘é¡µä¸­æ·»åŠ æ–°çš„ HTMLï¼Œä¿®æ”¹ç½‘é¡µå·²æœ‰å†…å®¹å’Œç½‘é¡µçš„æ ·å¼ã€‚
- å“åº”ç”¨æˆ·çš„è¡Œä¸ºï¼Œå“åº”é¼ æ ‡çš„ç‚¹å‡»ï¼ŒæŒ‡é’ˆçš„ç§»åŠ¨ï¼ŒæŒ‰é”®çš„æŒ‰åŠ¨ã€‚
- å‘è¿œç¨‹æœåŠ¡å™¨å‘é€ç½‘ç»œè¯·æ±‚ï¼Œä¸‹è½½å’Œä¸Šä¼ æ–‡ä»¶ï¼ˆæ‰€è°“çš„ [AJAX](<https://en.wikipedia.org/wiki/Ajax_(programming)>) å’Œ [COMET](<https://en.wikipedia.org/wiki/Comet_(programming)>) æŠ€æœ¯ï¼‰ã€‚
- è·å–æˆ–è®¾ç½® cookieï¼Œå‘è®¿é—®è€…æå‡ºé—®é¢˜æˆ–å‘é€æ¶ˆæ¯ã€‚
- è®°ä½å®¢æˆ·ç«¯çš„æ•°æ®ï¼ˆâ€œæœ¬åœ°å­˜å‚¨â€ï¼‰ã€‚

##### æµè§ˆå™¨ä¸­çš„ JavaScript ä¸èƒ½åšä»€ä¹ˆï¼Ÿ

- js ä¸èƒ½ç›´æ¥è®¿é—®æ“ä½œç³»ç»Ÿ
- ç»Ÿä¸€æµè§ˆå™¨çš„æ ‡ç­¾é¡µã€çª—å£ä¹‹é—´é€šå¸¸æ˜¯æ²¡æœ‰è”ç³»çš„ï¼ˆåŒæºç­–ç•¥ï¼‰
- js å¯ä»¥é€šè¿‡äº’è”ç½‘ä¸å½“å‰é¡µé¢æ‰€åœ¨çš„æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ï¼Œä½†æ˜¯ä»å…¶ä»–ç½‘ç«™/åŸŸçš„æœåŠ¡å™¨ä¸­æ¥å—æ•°æ®çš„èƒ½åŠ›è¢«å‰Šå¼±äº†ã€‚ï¼ˆéœ€è¦å“åº”å¤´é‡Œé¢æœ‰æ˜ç¡®çš„åè®®å»å…è®¸ï¼‰

##### ä»£ç è´¨é‡ï¼š

###### 1.åˆ†æ”¯ç»“æ„ï¼š

![image-20220705155030568](https://github.com/yinhongGITHUB/ReadingNotes/blob/main/images/ModernJSTutorial/image-20220705155030568.png)

###### 2.è¡Œçš„é•¿åº¦ï¼š

ä¸€è¡Œå°½é‡ä¸è¦è¶…è¿‡ä¸€ä¸ªå±å¹•ã€‚å®åœ¨å¤ªé•¿çš„è¯ï¼Œå¯ä»¥é‡‡ç”¨å¦‚ä¸‹æ–¹å¼ã€‚

```js
// å›å‹¾å¼•å· ` å…è®¸å°†å­—ç¬¦ä¸²æ‹†åˆ†ä¸ºå¤šè¡Œ
let str = `
  ECMA International's TC39 is a group of JavaScript developers,
  implementers, academics, and more, collaborating with the community
  to maintain and evolve the definition of JavaScript.
`;
```

###### 3.ç¼©è¿›

æ°´å¹³æ–¹å‘ï¼š2 æˆ– 4 ä¸ªç©ºæ ¼ï¼ˆä¸»è¦æ˜¯ä»£ç å¯¹é½ï¼‰

å‚ç›´æ–¹å‘ï¼šå…¶å®å°±æ˜¯åœ¨å„ä¸ªé€»è¾‘å—ä¹‹é—´ï¼Œç•™ä¸€è¡Œç©ºè¡Œä¾‹å¦‚ï¼š

```js
function pow(x, n) {
  let result = 1;
  // ä¸‹é¢å°±æ˜¯å‚ç›´æ–¹å‘çš„ç¼©è¿›ï¼Œä¾¿äºæå‡ä»£ç å¯è¯»æ€§
  //              <--
  for (let i = 0; i < n; i++) {
    result *= x;
  }

  //              <--
  return result;
}
```

###### 4.åˆ†å·ï¼š

js è™½ç„¶ä¸å¼ºåˆ¶æ¯ä¸€è¡Œåç»­å¿…é¡»æœ‰åˆ†å·ï¼Œä½†æ˜¯ï¼Œåœ¨ JavaScript ä¸­ï¼Œæå°‘æ•°æƒ…å†µä¸‹ï¼Œæ¢è¡Œç¬¦åˆæ˜¯ä¸ä¼šè¢«è§£é‡Šä¸ºåˆ†å·ï¼Œè¿™ç§ä»£ç å°±å®¹æ˜“å‡ºé”™ã€‚

##### æ±‚å¹‚

```js
alert(2 ** 2); // 2Â² = 4
alert(2 ** 3); // 2Â³ = 8
alert(2 ** 4); // 2â´ = 16
```

##### prompt ç”¨æ³•

å¼¹å‡ºä¸€ä¸ªå¯è¾“å…¥çš„å¯¹è¯æ¡†,

```js
result = window.prompt(text, value);
// text è¡¨ç¤ºæç¤ºä¿¡æ¯
// value æ–‡æœ¬è¾“å…¥æ¡†çš„é»˜è®¤å€¼
// result ç”¨æˆ·åœ¨æ–‡æœ¬è¾“å…¥æ¡†è¾“å…¥çš„æœ€ç»ˆå€¼
var sign = prompt("ä½ æ˜¯ä»€ä¹ˆæ˜Ÿåº§çš„ï¼Ÿ");
if (sign == "å¤©èåº§") {
  alert("å“‡ï¼æˆ‘ä¹Ÿæ˜¯å¤©èåº§çš„è€¶ï¼");
}
```

##### æ³¨é‡Š

å°½é‡é‡‡ç”¨ jsDoc çš„æ³¨é‡Šé£æ ¼ï¼Œå¹¶é¿å… â€œ è§£é‡Šå‹ â€ æ³¨é‡Š

â€œ è§£é‡Šå‹ â€ æ³¨é‡Šå®šä¹‰ï¼š

```js
// è¿™é‡Œçš„ä»£ç ä¼šå…ˆåšè¿™ä»¶äº‹ï¼ˆâ€¦â€¦ï¼‰ç„¶ååšé‚£ä»¶äº‹ï¼ˆâ€¦â€¦ï¼‰
```

æ­£ç¡®çš„ jsDoc æ³¨é‡Šï¼šï¼ˆæœ¬è´¨ï¼šç›´æ¥è¯´å‡ºä»£ç çš„åŠŸèƒ½ï¼Œè€Œä¸éœ€è¦è§£é‡Šæ¯è¡Œä»£ç åšäº†ä»€ä¹ˆï¼‰

```js
/**
 * è¿”å› x çš„ n æ¬¡å¹‚çš„å€¼ã€‚
 *
 * @param {number} x è¦æ”¹å˜çš„å€¼ã€‚
 * @param {number} n å¹‚æ•°ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªè‡ªç„¶æ•°ã€‚
 * @return {number} x çš„ n æ¬¡å¹‚çš„å€¼ã€‚
 */
function pow(x, n) {
  ...
}
```

###### æ‰©å±•ï¼š â€œ è‡ªæè¿°å‹ â€ ä»£ç 

```js
// å³å°†ä¸€éƒ¨åˆ†ä»£ç ç‹¬ç«‹å‡ºå»ï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œåªå…³æ³¨æŸä¸ªå‡½æ•°åšäº†ä»€ä¹ˆï¼Œ
function showPrimes(n) {
  for (let i = 2; i < n; i++) {
    if (!isPrime(i)) continue;
    alert(i);
  }
}

function isPrime(n) {
  for (let i = 2; i < n; i++) {
    if (n % i == 0) return false;
  }

  return true;
}
```

##### å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ˜¯å¦å­˜åœ¨

###### 1.in è¿ç®—ç¬¦

```js
let user = { name: "John", age: 30 };

alert("age" in user); // trueï¼Œuser.age å­˜åœ¨
alert("blabla" in user); // falseï¼Œuser.blabla ä¸å­˜åœ¨ã€‚
```

###### 2.if åˆ¤æ–­

```js
let user = { name: "John", age: 30 };
if(user.name=== undefined)
```

##### å¯¹è±¡å±æ€§çš„å¾ªåº

â€œ æœ‰ç‰¹åˆ«çš„é¡ºåº â€ï¼š1.æ•´æ•°å±æ€§ä¼šè¢«è¿›è¡Œæ’åºï¼Œ2.å…¶ä»–å±æ€§åˆ™æŒ‰ç…§åˆ›å»ºçš„é¡ºåºæ˜¾ç¤ºã€‚

â€œæ•´æ•°å±æ€§â€æŒ‡çš„æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨ä¸åšä»»ä½•æ›´æ”¹çš„æƒ…å†µä¸‹ä¸ä¸€ä¸ªæ•´æ•°è¿›è¡Œç›¸äº’è½¬æ¢çš„å­—ç¬¦ä¸²ã€‚å¦‚ï¼šâ€œ49â€ã€â€œ41â€

ä½†æ˜¯ï¼Œâ€œ1.2â€ã€â€œ+49â€ æ˜¯ä¸è¡Œçš„ã€‚

æ‰€ä»¥ï¼Œå¦‚æœä¸æƒ³è¦æ•´æ•°å±æ€§çš„æ’åºï¼Œé‚£ä¹ˆå¯ä»¥åœ¨æ¯ä¸ªå±æ€§å‰é¢åŠ ä¸€ä¸ªâ€œ+â€ï¼Œæ¬ºéª—ç¨‹åºï¼Œè¾¾åˆ°ç†æƒ³é¢„æœŸã€‚

###### 1.åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºç©º

```js
function isEmpty(obj) {
  for (let key in obj) {
    // å¦‚æœè¿›åˆ°å¾ªç¯é‡Œé¢ï¼Œè¯´æ˜æœ‰å±æ€§ã€‚
    return false;
  }
  return true;
}
```

##### åƒåœ¾å›æ”¶

###### 1.è§£å†³çš„é—®é¢˜ï¼šè¯†åˆ«å†…å­˜çš„æ­»åŒº

###### 2.åˆ¤å®šè§„åˆ™ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡å¯ä»¥é€šè¿‡ä¸€äº›æŒ‡é’ˆé“¾ä»ä¸€ä¸ªå®šä¹‰ä¸ºæ´»çš„å¯¹è±¡åˆ°è¾¾ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯æ´»çš„ã€‚å…¶ä»–çš„éƒ½æ˜¯åƒåœ¾ã€‚

å³ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡è¢«æ ¹å¯¹è±¡æˆ–å¦ä¸€ä¸ªæ´»åŠ¨å¯¹è±¡æŒ‡å‘ï¼ˆæŒ‡å‘å…¶å®å°±æ˜¯æŸå¯¹è±¡çš„å±æ€§å¼•ç”¨äº†è¿™ä¸ªå¯¹è±¡ï¼‰ï¼Œåˆ™è¯¥å¯¹è±¡æ˜¯*æ´»åŠ¨çš„*

```js
// è¿™å°±æ˜¯ä¸€ä¸ªæ ¹å¯¹è±¡ä¸‹çš„æ´»åŠ¨å¯¹è±¡
let a = {
  name: "å¼ ä¸‰",
};
a = null;
// é‚£ä¹ˆæ­¤æ—¶{name:"å¼ ä¸‰"}è¿™ä¸ªå¯¹è±¡å°±æ²¡æœ‰è¢«æ´»åŠ¨å¯¹è±¡æŒ‡å‘äº†ï¼Œå°±æˆäº†åƒåœ¾
```

##### å¯é€‰é“¾?.

###### 1.å®šä¹‰ï¼š

æ³¨æ„ï¼š?. è¿™ä¸ªå«åšå¯é€‰é“¾ï¼Œå¹¶ä¸è¦ç†è§£ä¸º? å’Œ . åˆ†å¼€ç†è§£æ˜¯é”™çš„

```js
let user = {}; // user æ²¡æœ‰ address å±æ€§

alert(user?.address?.street); // undefinedï¼ˆä¸æŠ¥é”™ï¼‰
```

###### 2.æ³¨æ„äº‹é¡¹

`?.`å‰çš„å˜é‡å¿…é¡»å·²å£°æ˜

ä¸è¦è¿‡åº¦ä½¿ç”¨å¯é€‰é“¾

###### 3.å…¶ä»–å˜ä½“:

?.() è°ƒç”¨æ–¹æ³•

```js
let userAdmin = {
  admin() {
    alert("I am admin");
  },
};

let userGuest = {};
userAdmin.admin?.(); // I am admin
userGuest.admin?.(); // å•¥éƒ½æ²¡å‘ç”Ÿï¼ˆæ²¡æœ‰è¿™æ ·çš„æ–¹æ³•ï¼‰
```

?.[] è·å–å¯¹è±¡å±æ€§

```js
let key = "firstName";

let user1 = {
  firstName: "John",
};

let user2 = null;

alert(user1?.[key]); // John
alert(user2?.[key]); // undefined
```

##### Symbol ä¸å¯è½¬æ¢æˆå…¶ä»–ç±»å‹ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²

```js
let a = Symbol("1");
alert(a); // è¿™é‡Œä¼šæŠ¥é”™ï¼Œalertä¼šå¼ºåˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²è¾“å‡ºï¼Œä½†æ˜¯Symbolä¸å¯è½¬æ¢ï¼Œæ•…æŠ¥é”™
```

æ³¨æ„ï¼šalert ä¼šæ‰“å°å­—ç¬¦ä¸²ï¼Œç»™å®ƒçš„å€¼ï¼Œä¼šå¼ºåˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œè½¬ä¸äº†å°±æŠ¥é”™

##### å­—ç¬¦ä¸²è°ƒç”¨æ–¹æ³•çš„è¿‡ç¨‹

æ³¨æ„ï¼šåŸå§‹ç±»å‹æœ¬èº«ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡,åªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶å¯¹è±¡å»å‚¨å­˜è¿™ä¸ªåŸå§‹ç±»å‹çš„å€¼

```js
let str = "Hello";

alert( str.toUpperCase() ); // HELLO

1. å­—ç¬¦ä¸² str æ˜¯ä¸€ä¸ªåŸå§‹å€¼ã€‚å› æ­¤ï¼Œåœ¨è®¿é—®å…¶å±æ€§æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²å­—é¢å€¼çš„ç‰¹æ®Šå¯¹è±¡ï¼Œå¹¶ä¸”å…·æœ‰å¯ç”¨çš„æ–¹æ³•ï¼Œä¾‹å¦‚ toUpperCase()ã€‚
2. è¯¥æ–¹æ³•è¿è¡Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼ˆç”± alert æ˜¾ç¤ºï¼‰ã€‚
3. ç‰¹æ®Šå¯¹è±¡è¢«é”€æ¯ï¼Œåªç•™ä¸‹åŸå§‹å€¼ strã€‚
```

```js
let str = "Hello";

str.test = 5; // (*)

alert(str.test);
// undefinedï¼ˆéä¸¥æ ¼æ¨¡å¼ï¼‰
// æŠ¥é”™ï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰ã€‚
/*
ä¸ºä»€ä¹ˆï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹åœ¨ (*) é‚£ä¸€è¡Œåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼š

å½“è®¿é—® str çš„å±æ€§æ—¶ï¼Œä¸€ä¸ªâ€œå¯¹è±¡åŒ…è£…å™¨â€è¢«åˆ›å»ºäº†ã€‚
åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå‘å…¶å†™å…¥å†…å®¹ä¼šæŠ¥é”™ã€‚
å¦åˆ™ï¼Œå°†ç»§ç»­æ‰§è¡Œå¸¦æœ‰å±æ€§çš„æ“ä½œï¼Œè¯¥å¯¹è±¡å°†è·å¾— test å±æ€§ï¼Œä½†æ˜¯æ­¤åï¼Œâ€œå¯¹è±¡åŒ…è£…å™¨â€å°†æ¶ˆå¤±ï¼Œå› æ­¤åœ¨æœ€åä¸€è¡Œï¼Œstr å¹¶æ²¡æœ‰è¯¥å±æ€§çš„è¸ªè¿¹ã€‚
*/
```

##### null/undefined æ²¡æœ‰ä»»ä½•æ–¹æ³•ï¼Œä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼Œä»–ä»¬æ˜¯ â€ æœ€åŸå§‹çš„ â€œ

##### æ•°å­—è¡¨ç¤º

```js
1e3 === 1 * 1000; // e3 è¡¨ç¤ºæœ‰3ä¸ª0
1e-3 === 1 / 1000; // e-3 è¡¨ç¤ºé™¤ä»¥3ä¸ª0
```

##### 0.1+0.2 !== 0.3

###### ç†è§£ï¼š

```js
ä»€ä¹ˆæ˜¯ 0.1ï¼Ÿ0.1 å°±æ˜¯ 1 é™¤ä»¥ 10ï¼Œ1/10ï¼Œå³ååˆ†ä¹‹ä¸€ã€‚åœ¨åè¿›åˆ¶æ•°å­—ç³»ç»Ÿä¸­ï¼Œè¿™æ ·çš„æ•°å­—è¡¨ç¤ºèµ·æ¥å¾ˆå®¹æ˜“ã€‚å°†å…¶ä¸ä¸‰åˆ†ä¹‹ä¸€è¿›è¡Œæ¯”è¾ƒï¼š1/3ã€‚ä¸‰åˆ†ä¹‹ä¸€å˜æˆäº†æ— é™å¾ªç¯å°æ•° 0.33333(3)ã€‚
// åŠ å…¥åè¿›åˆ¶ï¼Œè¿›è¡Œæ¯”è¾ƒï¼Œæ›´åŠ ä¾¿äºç†è§£
åœ¨äºŒè¿›åˆ¶æ•°å­—ç³»ç»Ÿä¸­ï¼Œå¯ä»¥ä¿è¯ä»¥ 2 çš„æ•´æ•°æ¬¡å¹‚ä½œä¸ºé™¤æ•°æ—¶èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œå…¶ä»–æ•°ä½œä¸ºé™¤æ•°æ—¶ï¼Œéƒ½ä¼šå‡ºç°æ— é™å°æ•°çš„æƒ…å†µ
ä½¿ç”¨äºŒè¿›åˆ¶æ•°å­—ç³»ç»Ÿæ— æ³• ç²¾ç¡® å­˜å‚¨ 0.1 æˆ– 0.2ï¼Œå°±åƒæ²¡æœ‰åŠæ³•å°†ä¸‰åˆ†ä¹‹ä¸€å­˜å‚¨ä¸ºåè¿›åˆ¶å°æ•°ä¸€æ ·ã€‚

0.1.toFixed(20)// 0.10000000000000000555
0.2.toFixed(20)// 0.20000000000000001110
0.3.toFixed(20)// 0.29999999999999998890
0.4.toFixed(20)// 0.40000000000000002220
0.5.toFixed(20)// 0.50000000000000000000// åªæœ‰åˆ†æ¯æ˜¯2çš„æ•´æ•°æ¬¡å¹‚æ—¶ï¼Œæ‰ä¼šå‡†ç¡®å­˜å‚¨
```

###### è§£å†³åŠæ³•ï¼š

æ³¨æ„ï¼š0.1 å’Œ 0.2 éƒ½æ‰©å¤§åå€ï¼Œç¡®å®å¯ä»¥å‡†ç¡®è®¡ç®—ï¼Œé‚£ 0.28+0.14 å‘¢ï¼Ÿæ‰©å¤§ä¸€ç™¾å€ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸ç­‰äº 0.42

**æ‰€ä»¥ï¼Œå€æ•°æ‰©å¤§å¯ä»¥å‡å°è¯¯å·®ï¼Œä½†æ˜¯ä¸èƒ½æ¶ˆé™¤è¯¯å·®**

æ›´ä¼˜çš„è§£å†³åŠæ³•æ˜¯ï¼š**åŠæ—¶æ–©æ–­å°¾å·´**ã€‚è¯´å‡ºè¿™ç§è¯å°±è¡¨ç¤ºï¼Œjs æœ¬èº«è¯­è¨€çš„ç¼ºé™·å°±æ˜¯ä¸èƒ½è¡¨ç¤ºå°æ•°ï¼Œè¿™æ˜¯æ— æ³•æ¶ˆé™¤çš„ï¼Œåªèƒ½æƒ³åŠæ³•é¿å…ã€‚

##### 0 å’Œ -0

åœ¨å‚¨å­˜æ—¶ï¼Œè¿˜æœ‰ä¸€ä½ç¬¦å·ä½ï¼Œè¿™ç§åŒºåˆ«å¹¶ä¸æ˜æ˜¾ï¼Œå› ä¸ºè¿ç®—ç¬¦å°†å®ƒä»¬è§†ä¸ºç›¸åŒçš„å€¼ã€‚

##### æ³¨æ„ï¼šåœ¨æ‰€æœ‰æ•°å­—å‡½æ•°ä¸­ï¼ŒåŒ…æ‹¬ `isFinite`ï¼Œç©ºå­—ç¬¦ä¸²æˆ–ä»…æœ‰ç©ºæ ¼çš„å­—ç¬¦ä¸²å‡è¢«è§†ä¸º `0`

##### ç”¨`Object.is` è¿›è¡Œæ¯”è¾ƒ

æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å†…å»ºæ–¹æ³• `Object.is`ï¼Œå®ƒç±»ä¼¼äº `===` ä¸€æ ·å¯¹å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä½†å®ƒå¯¹äºä¸¤ç§è¾¹ç¼˜æƒ…å†µæ›´å¯é ï¼š

1. å®ƒé€‚ç”¨äº `NaN`ï¼š`Object.is(NaN, NaN) ===> true`ï¼Œè¿™æ˜¯ä»¶å¥½äº‹(æ­¤æ—¶ NaN çš„å”¯ä¸€æ€§ä»¿ä½›æ¶ˆå¤±äº†)ã€‚
2. å€¼ `0` å’Œ `-0` æ˜¯ä¸åŒçš„ï¼š`Object.is(0,-0) === false`ï¼Œä»æŠ€æœ¯ä¸Šè®²è¿™æ˜¯å¯¹çš„ï¼Œå› ä¸ºåœ¨å†…éƒ¨ï¼Œæ•°å­—çš„ç¬¦å·ä½å¯èƒ½ä¼šä¸åŒï¼Œå³ä½¿å…¶ä»–æ‰€æœ‰ä½å‡ä¸ºé›¶ã€‚

åœ¨æ‰€æœ‰å…¶ä»–æƒ…å†µä¸‹ï¼Œ`Object.is(a, b)` ä¸ `a === b` ç›¸åŒã€‚

è¿™ç§æ¯”è¾ƒæ–¹å¼ç»å¸¸è¢«ç”¨åœ¨ JavaScript è§„èŒƒä¸­ã€‚å½“å†…éƒ¨ç®—æ³•éœ€è¦æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦å®Œå…¨ç›¸åŒæ—¶ï¼Œå®ƒä½¿ç”¨ `Object.is`ï¼ˆå†…éƒ¨ç§°ä¸º [SameValue](https://tc39.github.io/ecma262/#sec-samevalue)ï¼‰ã€‚

##### å–å›ºå®šåŒºåŸŸéšæœºæ•´æ•°æ•°çš„æ–¹æ³•

```js
function randomInteger(min, max) {
  //åŠ ä¸€æ˜¯ä¸ºäº†ç¡®ä¿æ¯ä¸ªæ•´æ•°å–åˆ°çš„æ¦‚ç‡éƒ½æ˜¯ä¸€æ ·çš„   å› ä¸ºMath.random()æ˜¯0åˆ°1çš„éšæœºæ•°ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬1æ‰€ä»¥è¦åŠ ä¸€
  let rand = min + Math.random() * (max + 1 - min);
  //å‘ä¸‹å–æ•´
  return Math.floor(rand);
}
```

##### splice

å…è®¸è´Ÿå‘ç´¢å¼•

```js
let arr = [1, 2, 5];

// ä»ç´¢å¼• -1ï¼ˆå°¾ç«¯å‰ä¸€ä½ï¼‰
// åˆ é™¤ 0 ä¸ªå…ƒç´ ï¼Œ
// ç„¶åæ’å…¥ 3 å’Œ 4
arr.splice(-1, 0, 3, 4);

alert(arr); // 1,2,3,4,5
// è´Ÿå‡ å°±æ˜¯å°¾ç«¯çš„å‰å‡ ä½ï¼Œå¾ˆå®¹æ˜“æ³¨æ„åˆ°ï¼Œspliceæ˜¯æ²¡æœ‰åŠæ³•ç›´æ¥å†æœ€åä¸€ä½ä¹‹åæ·»åŠ å…ƒç´ çš„
```

##### concat

å¦‚æœ**ç±»æ•°ç»„**å¯¹è±¡å…·æœ‰ `Symbol.isConcatSpreadable` å±æ€§ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¢« `concat` å½“ä½œä¸€ä¸ªæ•°ç»„æ¥å¤„ç†ï¼šæ­¤å¯¹è±¡ä¸­çš„å…ƒç´ å°†è¢«æ·»åŠ 

æ³¨ï¼šconcat ä¸ä¼šæ”¹å˜åŸæ•°ç»„ï¼Œä¸ç®¡æ˜¯ä¸‹æ–¹çš„ arr æˆ–è€… arrayLikeï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°æ•°ç»„

```js
let arr = [1, 2];

let arrayLike = {
  0: "something",
  1: "else",
  [Symbol.isConcatSpreadable]: true,
  length: 2,
};

alert(arr.concat(arrayLike)); // 1,2,something,else
```

##### includes å¯ä»¥å¤„ç† NaN

```js
const arr = [NaN];
alert(arr.indexOf(NaN)); // -1ï¼ˆé”™ï¼Œåº”è¯¥ä¸º 0ï¼‰
alert(arr.includes(NaN)); // trueï¼ˆæ­£ç¡®ï¼‰
// è¿™æ˜¯å› ä¸º includes æ˜¯åœ¨æ¯”è¾ƒæ™šçš„æ—¶å€™æ‰è¢«æ·»åŠ åˆ° JavaScript ä¸­çš„ï¼Œå¹¶ä¸”åœ¨å†…éƒ¨ä½¿ç”¨äº†æ›´æ–°äº†çš„æ¯”è¾ƒç®—æ³•ã€‚
```

##### sort

sort é»˜è®¤å°†æ•°ç»„ä¸­çš„å€¼å˜æˆå­—ç¬¦ä¸²ï¼Œç„¶åç”¨ä»–ä»¬çš„ UTF-16 è¿›è¡Œæ¯”è¾ƒï¼Œä¾‹å¦‚ï¼š

```js
let arr = [1, 2, 15];

// è¯¥æ–¹æ³•é‡æ–°æ’åˆ— arr çš„å†…å®¹
arr.sort();

alert(arr); // 1, 15, 2
// å› ä¸º "2" > "15" æ‰€ä»¥2ä¼šæ’åœ¨15åé¢
// æƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜
arr.sort((a, b) => a - b);
// aã€bæ˜¯ä¸¤ä¸ªç›¸é‚»çš„é¡¹
// å›è°ƒå‡½æ•°è¿”å›å€¼ä¸ºæ­£æ•°æ—¶ï¼Œaã€bäº’æ¢ã€‚ä¸º0æ—¶ï¼Œaã€bä¸åŠ¨ã€‚ä¸ºè´Ÿæ•°æ—¶ï¼Œaã€bä¸åŠ¨
```

##### localeCompare

æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„å¤§å°ï¼Œå¯é…åˆä¸Šé¢çš„ sort ä½¿ç”¨

```js
let countries = ['Ã–sterreich', 'Andorra', 'Vietnam'];
countries.sort( (a, b) => a.localeCompare(b)
// å‰æï¼Œå­—ç¬¦ä¸²å¯¹è±¡ä¸‹é¢æ‰æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œç”¨äºæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„å¤§å°
```

##### å¯è¿­ä»£çš„å¯¹è±¡çš„å…³é”®

1. Symbol.iteratorï¼šè¿­ä»£å™¨ï¼Œ

2. next()æ–¹æ³•

```js
// å†™æ³•ä¸€
let obj = {
  from: 1,
  to: 5,
  // è¿­ä»£å™¨
  [Symbol.iterator]() {
    this.current = this.from;
    return this;
  },
  // ä¸‹ä¸€æ­¥
  // next() æ–¹æ³•è¿”å›çš„ç»“æœçš„æ ¼å¼å¿…é¡»æ˜¯ {done: Boolean, value: any}ï¼Œå½“ done=true æ—¶ï¼Œè¡¨ç¤ºå¾ªç¯ç»“æŸï¼Œå¦åˆ™ value æ˜¯ä¸‹ä¸€ä¸ªå€¼
  next() {
    if (this.current <= this.to) {
      return { done: false, value: this.current++ };
    } else {
      return { done: true };
    }
  },
};

for (let key of obj) {
  console.log(key); // 1,2,3,4,5
}
// å†™æ³•äºŒï¼ˆæ¨èâ­ï¼‰
let range = {
  from: 1,
  to: 5,
};
// ç»™rangeåŠ ä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¿­ä»£å™¨å¯ä»¥è®©å½“å‰å¯¹è±¡å˜æˆä¸€ä¸ªå¯æšä¸¾çš„å¯¹è±¡
range[Symbol.iterator] = function () {
  return {
    current: this.from,
    last: this.to,
    next: function () {
      if (this.current <= this.last) {
        return {
          done: false,
          value: this.current++,
        };
      } else {
        return {
          done: true,
        };
      }
    },
  };
};

for (let key of range) {
  console.log(key); // 1,2,3,4,5
}
```

##### å…³äº Map ä½ ä¸çŸ¥é“çš„äº‹æƒ…

###### 1.map è·å–æ•°æ®çš„ä¸¤ç§æ–¹å¼

```js
// ç¬¬ä¸€ç§
map.get(key);
// ç¬¬äºŒç§,è¿™æ ·ä¼šå°†è¯¥mapè§†ä¸ºJavaScriptçš„plain objectï¼Œå› æ­¤å®ƒæš—å«äº†æ‰€æœ‰ç›¸åº”çš„é™åˆ¶ï¼ˆä»…æ”¯æŒstring/symbolï¼‰è€Œä¸”ï¼Œmap[key]è·å–ä¸åˆ°æ­£å¸¸è®¾ç½®çš„mapå…ƒç´ ï¼Œä¾‹å­å¦‚ä¸‹ï¼š
map[key];
let a = new Map([
  ["name", "å¼ ä¸‰"],
  [21, "æå››"],
]);

console.log(a.get("name"));
let key = "name";
a[key] = 2;
console.log(a[key]);
// æ­¤æ—¶mapæ•°æ®ç»“æ„å¦‚ä¸‹ï¼Œå¯ä»¥æ˜æ˜¾çœ‹åˆ°ï¼Œsetè®¾ç½®çš„å…ƒç´ å’Œç›´æ¥map[key]è®¾ç½®çš„å…ƒç´ æ˜¯å®Œå…¨ä¸åŒçš„ï¼Œæ‰€ä»¥ä¸å¯èƒ½äº’é€šæ‹¿å–ï¼ˆäº’é€šæ‹¿å–å®šä¹‰ï¼šsetè®¾ç½®çš„å…ƒç´ ï¼Œmap[key]è·å–ä¸åˆ°ï¼‰
```

![image-20220926105518658](https://github.com/yinhongGITHUB/ReadingNotes/blob/main/images/ModernJSTutorial/image-20220926105518658.png)

###### 2.Map çš„ key å¯ä»¥æ˜¯å¯¹è±¡ä»¥åŠä»»æ„ç±»å‹ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œ`Map` æ˜¯æ€ä¹ˆæ¯”è¾ƒé”®çš„ï¼Ÿ

`Map` ä½¿ç”¨ [SameValueZero](https://tc39.github.io/ecma262/#sec-samevaluezero) ç®—æ³•æ¥æ¯”è¾ƒé”®æ˜¯å¦ç›¸ç­‰ã€‚å®ƒå’Œä¸¥æ ¼ç­‰äº `===` å·®ä¸å¤šï¼Œä½†åŒºåˆ«æ˜¯ `NaN` è¢«çœ‹æˆæ˜¯ç­‰äº `NaN`ã€‚æ‰€ä»¥ `NaN` ä¹Ÿå¯ä»¥è¢«ç”¨ä½œé”®ã€‚

è¿™ä¸ªç®—æ³•ä¸èƒ½è¢«æ”¹å˜æˆ–è€…è‡ªå®šä¹‰ã€‚

###### 3.**é“¾å¼è°ƒç”¨**

æ¯ä¸€æ¬¡ `map.set` è°ƒç”¨éƒ½ä¼šè¿”å› map æœ¬èº«ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›è¡Œâ€œé“¾å¼â€è°ƒç”¨ï¼š

```javascript
map.set("1", "str1").set(1, "num1").set(true, "bool1");
```

###### 3.å…³äº map å¦‚ä½•è¿­ä»£

```js
map.keys() â€”â€” éå†å¹¶è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰é”®çš„å¯è¿­ä»£å¯¹è±¡ï¼Œ
map.values() â€”â€” éå†å¹¶è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å€¼çš„å¯è¿­ä»£å¯¹è±¡ï¼Œ
map.entries() â€”â€” éå†å¹¶è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å®ä½“ [key, value] çš„å¯è¿­ä»£å¯¹è±¡ï¼Œfor..of åœ¨é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„å°±æ˜¯è¿™ä¸ªã€‚
```

æ³¨æ„ï¼šè¿­ä»£çš„é¡ºåºä¸æ’å…¥å€¼çš„é¡ºåºç›¸åŒ

##### set æ³¨æ„äº‹é¡¹

set æ˜¯æ²¡æœ‰ â€œ é”® â€ çš„ï¼Œåªæœ‰å€¼ï¼Œå¹¶ä¸”ï¼Œæ¯ä¸ªå€¼åªèƒ½å‡ºç°ä¸€æ¬¡ã€‚

##### Array.from æ³¨æ„äº‹é¡¹

```js
var obj = new Object({
  name: "web_sea",
  age: 18,
  isRich: [false, true],
});
//å°†å¯¹è±¡è½¬æˆæ•°ç»„
var objs = [];
for (var i in obj) {
  objs.push(obj[i]);
}

var arrObj = Array.from(objs);
console.log("objs:", objs); //objs: [ 'web_sea', 18, [false,true] ]
console.log("arrObj:", arrObj); //arrObj:[ 'web_sea', 18, [false,true] ]
//æˆ‘ä»¬è¦æ”¹å˜objså­å¯¹è±¡çš„å€¼ï¼›
objs[2][0] = "å“ˆå“ˆå“ˆå“ˆ";
//æ”¹å˜ç¬¬ä¸€å±‚æ•°æ®çš„å€¼
objs[1] = 50;
console.log("æ”¹å˜objsåobjs:", objs); //[ 'web_sea', 50, [ true, true ] ]
console.log("æ”¹å˜objsåarrObj:", arrObj); //arrObj:[ 'web_sea', 18, [ true, true ] ]
```

ç»“è®ºï¼šArray.from çš„å­å¯¹è±¡æ˜¯æµ…æ‹·è´ï¼Œæ‰€ä»¥ï¼ŒArray.from æ˜¯æµ…æ‹·è´ï¼Œä½†æ˜¯ Array.from çš„ç¬¬ä¸€å±‚è¿˜æ˜¯æ·±æ‹·è´çš„ï¼Œè¿™ç‚¹è¦æ³¨æ„å“¦

##### WeakMap æ³¨æ„äº‹é¡¹

1. ###### WeakMap çš„ key**åªèƒ½æ˜¯**å¯¹è±¡ï¼Œè€Œä¸”è¿™ä¸ª key å·²ç»ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶ï¼Œä½†æ˜¯ map çš„ keyï¼Œåªè¦å­˜äº†ï¼Œå°±ä¸ä¼šä¸¢å¤±ã€‚å¦‚ä¸‹ï¼š

```js
// 1. weakMapçš„keyåªèƒ½æ˜¯å¯¹è±¡
let weakMap = new WeakMap();

let obj = {};

weakMap.set(obj, "ok"); // æ­£å¸¸å·¥ä½œï¼ˆä»¥å¯¹è±¡ä½œä¸ºé”®ï¼‰

// ä¸èƒ½ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºé”®
weakMap.set("test", "Whoops"); // Errorï¼Œå› ä¸º "test" ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡
let john = { name: "John" };

// 2. weakMapçš„keyå°±ç®—å­˜å‚¨äº†å€¼ï¼Œä¹Ÿå·²ç»ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶å†…å­˜
let weakMap = new WeakMap();
weakMap.set(john, "...");

john = null; // è¦†ç›–å¼•ç”¨

// john è¢«ä»å†…å­˜ä¸­åˆ é™¤äº†ï¼
// æ³¨æ„ï¼š å¦‚æœ john æ¶ˆå¤±ï¼Œ"..." å°†ä¼šè¢«è‡ªåŠ¨æ¸…é™¤
```

2. ###### WeakMap æœ‰å¦‚ä¸‹æ–¹æ³•ï¼Œæš‚ä¸æ”¯æŒè·å– WeakMap çš„æ‰€æœ‰é”®/å€¼çš„æ–¹æ³•

```js
weakMap.get(key);
weakMap.set(key, value);
weakMap.delete(key);
weakMap.has(key);
```

3. ###### ä½¿ç”¨åœºæ™¯

ä½¿ç”¨åœºæ™¯ä¸€ï¼š

ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ç”¨äºå¤„ç†ç”¨æˆ·è®¿é—®è®¡æ•°çš„ä»£ç ã€‚æ”¶é›†åˆ°çš„ä¿¡æ¯è¢«å­˜å‚¨åœ¨ map ä¸­ï¼šä¸€ä¸ªç”¨æˆ·å¯¹è±¡ä½œä¸ºé”®ï¼Œå…¶è®¿é—®æ¬¡æ•°ä¸ºå€¼ã€‚å½“ä¸€ä¸ªç”¨æˆ·ç¦»å¼€æ—¶ï¼ˆè¯¥ç”¨æˆ·å¯¹è±¡å°†è¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶ï¼‰ï¼Œè¿™æ—¶æˆ‘ä»¬å°±ä¸å†éœ€è¦ä»–çš„è®¿é—®æ¬¡æ•°äº†ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ `Map` çš„è®¡æ•°å‡½æ•°çš„ä¾‹å­ï¼š

```js
// ğŸ“ visitsCount.js
let visitsCountMap = new Map(); // map: user => visits count

// é€’å¢ç”¨æˆ·æ¥è®¿æ¬¡æ•°
function countUser(user) {
  let count = visitsCountMap.get(user) || 0;
  visitsCountMap.set(user, count + 1);
}
// ğŸ“ main.js
let john = { name: "John" };

countUser(john); // count his visits

// ä¸ä¹…ä¹‹åï¼Œjohn ç¦»å¼€äº†
john = null;
```

ç°åœ¨ï¼Œ`john` è¿™ä¸ªå¯¹è±¡åº”è¯¥è¢«åƒåœ¾å›æ”¶ï¼Œä½†å®ƒä»åœ¨å†…å­˜ä¸­ï¼Œå› ä¸ºå®ƒæ˜¯ `visitsCountMap` ä¸­çš„ä¸€ä¸ªé”®ã€‚

å½“æˆ‘ä»¬ç§»é™¤ç”¨æˆ·æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ¸…ç† `visitsCountMap`ï¼Œå¦åˆ™å®ƒå°†åœ¨å†…å­˜ä¸­æ— é™å¢å¤§ã€‚åœ¨å¤æ‚çš„æ¶æ„ä¸­ï¼Œè¿™ç§æ¸…ç†ä¼šæˆä¸ºä¸€é¡¹ç¹é‡çš„ä»»åŠ¡ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ `WeakMap` æ¥é¿å…è¿™æ ·çš„é—®é¢˜ï¼š

```js
// ğŸ“ visitsCount.js
let visitsCountMap = new WeakMap(); // weakmap: user => visits count

// é€’å¢ç”¨æˆ·æ¥è®¿æ¬¡æ•°
function countUser(user) {
  let count = visitsCountMap.get(user) || 0;
  visitsCountMap.set(user, count + 1);
}
```

æ€»ç»“ï¼šWeakMap å’Œ Map çš„åŒºåˆ«å°±æ˜¯ï¼ŒWeakMap ä¸éœ€è¦æ‰‹åŠ¨å»æ¸…æ¥šï¼Œé¿å…äº†å¾ˆå¤šéº»çƒ¦ï¼Œå½“ john ç¦»å¼€æ—¶ï¼Œåˆ©ç”¨åƒåœ¾æ¸…é™¤æœºåˆ¶ï¼Œè‡ªåŠ¨æ¸…æ¥šäº†è¯¥æ¡æ•°æ®ã€‚

##### WeakSet æ³¨æ„äº‹é¡¹

WeakSet è·Ÿ WeakMap çš„ç‰¹æ€§å·®ä¸å¤šï¼Œä¹Ÿæ˜¯åªèƒ½æ·»åŠ å¯¹è±¡

##### WeakMap/WeakSet å¤§æ€»ç»“

`WeakMap/WeakSet` å®Œæˆå…¶ä¸»è¦å·¥ä½œ â€”â€” ä¸ºåœ¨å…¶å®ƒåœ°æ–¹å­˜å‚¨/ç®¡ç†çš„å¯¹è±¡æ•°æ®æä¾›â€œé¢å¤–â€å­˜å‚¨ã€‚å³é¢å¤–å­˜å‚¨çš„æ•°æ®ä¼šéšç€å¯¹è±¡çš„æ¶ˆå¤±è€Œæ¶ˆå¤±ã€‚

`WeakMap` æ˜¯ç±»ä¼¼äº `Map` çš„é›†åˆï¼Œå®ƒä»…å…è®¸å¯¹è±¡ä½œä¸ºé”®ï¼Œå¹¶ä¸”ä¸€æ—¦é€šè¿‡å…¶ä»–æ–¹å¼æ— æ³•è®¿é—®è¿™äº›å¯¹è±¡ï¼Œåƒåœ¾å›æ”¶ä¾¿ä¼šå°†è¿™äº›å¯¹è±¡ä¸å…¶å…³è”å€¼ä¸€åŒåˆ é™¤ã€‚

`WeakSet` æ˜¯ç±»ä¼¼äº `Set` çš„é›†åˆï¼Œå®ƒä»…å­˜å‚¨å¯¹è±¡ï¼Œå¹¶ä¸”ä¸€æ—¦é€šè¿‡å…¶ä»–æ–¹å¼æ— æ³•è®¿é—®è¿™äº›å¯¹è±¡ï¼Œåƒåœ¾å›æ”¶ä¾¿ä¼šå°†è¿™äº›å¯¹è±¡åˆ é™¤ã€‚

##### å¯¹è±¡ç»“æ„èµ‹å€¼æ—¶æ³¨æ„ç‚¹

###### 1.å½“è§£æ„æ—¶å’Œ let ä¸åœ¨ä¸€è¡Œæ—¶ï¼Œé˜²æ­¢è¢«å½“æˆä»£ç å—è§£æ

```js
let title, width, height;

// è¿™ä¸€è¡Œå‘ç”Ÿäº†é”™è¯¯
{title, width, height} = {title: "Menu", width: 200, height: 100};
// æŠ¥é”™åŸå› ï¼š
// jsæŠŠ â€œ ä¸»ä»£ç æµ â€ çš„{}å½“ä½œä¸€ä¸ªä»£ç å—ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç»“æ„èµ‹å€¼è¯­å¥ï¼Œå°±ä¼šæŠ¥é”™
// è§£å†³åŠæ³•å¦‚ä¸‹ï¼šç”¨æ‹¬å·æ‹¬èµ·æ¥å°±å¯ä»¥äº†
({title, width, height} = {title: "Menu", width: 200, height: 100});
```

###### 2.è§£æ„èµ‹å€¼å†å‡½æ•°å‚æ•°ä¸Šçš„å¦™ç”¨

```js
// è¿™æ ·åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œé¦–å…ˆå‚æ•°å¯¹è±¡æˆäº†éå¿…å¡«é¡¹ï¼Œå½“æ‰€æœ‰å‚æ•°éƒ½ç”¨é»˜è®¤å€¼æ—¶ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨è€Œä¸ç”¨ä¼ å…¥ç©ºå¯¹è±¡
// ç„¶åä»ç©ºå¯¹è±¡ä¸Šé¢è¿›è¡Œè§£æ„èµ‹å€¼çš„å±æ€§éƒ½ç»™äºˆäº†é»˜è®¤å€¼
function showMenu({ title = "Menu", width = 100, height = 200 } = {}) {
  alert(`${title} ${width} ${height}`);
}

showMenu();
```

##### åŸºå‡†æµ‹è¯•çš„å®šä¹‰

è¿™ç§æ€§èƒ½æµ‹é‡é€šå¸¸ç§°ä¸ºâ€œåŸºå‡†æµ‹è¯•ï¼ˆbenchmarkï¼‰â€ã€‚

æ¯”å¦‚è®¡ç®—ä¸¤ä¸ªåŒæ ·åŠŸèƒ½çš„å‡½æ•°å“ªä¸ªæ›´å¿«

##### JSON.stringify çš„ä¸‰ä¸ªå‚æ•°

ç¬¬ä¸€ä¸ªå‚æ•°ï¼šéœ€è¦è½¬ç¼–ç çš„å€¼

ç¬¬äºŒä¸ªå‚æ•°ï¼šä¸€ä¸ªå‡½æ•°æˆ–ä¸€ä¸ªæ•°ç»„ï¼Œä¸¤ä¸ªå‚æ•°ï¼Œ(key,value)=>{} key å°±æ˜¯å¯¹è±¡çš„ keyï¼Œvalue å°±æ˜¯å¯¹è±¡çš„ valueï¼Œå¯ä»¥è®¾ç½®å“ªäº›å±æ€§è¢«è½¬åŒ–æˆ JSON å­—ç¬¦ä¸²ã€‚æ•°ç»„çš„è¯å°±æ˜¯å­—ç¬¦ä¸²æ•°ç»„ï¼ŒåŒ…æ‹¬å“ªäº›å±æ€§è¢«è½¬åŒ–æˆ JSON å­—ç¬¦ä¸²çš„ keyã€‚

ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šæ ¼å¼åŒ–ç©ºæ ¼çš„æ•°é‡ï¼ˆå³ JSON å­—ç¬¦ä¸²ä¼šæ¢è¡Œï¼Œæ¯è¡Œå‰é¢æœ‰å‡ ä¸ªç©ºæ ¼å‘¢ï¼Ÿå°±æ˜¯è¿™é‡Œè®¾ç½®çš„ï¼‰

æ³¨æ„ï¼šè·Ÿ JSON.parse ä¸åŒï¼Œç¬¬äºŒä¸ªå‚æ•°å‡½æ•°ï¼Œå°±æ˜¯è®¾ç½®å“ªäº›å±æ€§è¿›è¿”å›ç»“æœçš„ï¼Œæ‰€ä»¥ç›´æ¥åˆ¤æ–­å“ªäº›ç†Ÿæ‚‰å¯ä»¥è¿›ç»“æœã€‚

```js
let meetup = {
  title: "Conference",
  participants: [{ name: "John" }, { name: "Alice" }],
};

console.log(
  JSON.stringify(meetup, function replacer(key, value) {
    return key == "title" ? undefined : value;
  })
);
```

##### JSON.parse çš„ä¸¤ä¸ªå‚æ•°

ç¬¬ä¸€ä¸ªå‚æ•°ï¼šéœ€è¦è½¬ç¼–ç çš„å€¼ã€‚

ç¬¬äºŒä¸ªå‚æ•°ï¼šä¸€ä¸ªå‡½æ•°,ä¸¤ä¸ªå‚æ•°ï¼Œ(key,value)=>{} key å°±æ˜¯å¯¹è±¡çš„ keyï¼Œvalue å°±æ˜¯å¯¹è±¡çš„ valueï¼Œå¯ä»¥è®¾ç½®å“ªäº›å±æ€§è¿”å›ä»€ä¹ˆå“ªäº›ä¸è¿”å›ã€‚

æ³¨æ„ï¼šå‡½æ•°å¿…é¡»æœ‰ return value;ä¸ç„¶ä¼šæ˜¯ undefinedã€‚

```js
let str = '{"title":"Conference","date":"2017-11-30T12:00:00.000Z"}';

let meetup = JSON.parse(str, function (key, value) {
  if (key == "date") return undefined;
  return value;
});

console.log(meetup);
```

##### ç®­å¤´å‡½æ•°

ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªèº«çš„ `this`ã€‚ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†å®ƒä»¬ä¹Ÿæ²¡æœ‰ç‰¹æ®Šçš„ `arguments` å¯¹è±¡

`arguments` åªæ˜¯ä¸€ä¸ªç±»æ•°ç»„çš„å¯è¿­ä»£å¯¹è±¡ï¼Œå¹¶æ²¡æœ‰æ•°ç»„å¯¹è±¡çš„é‚£äº›æ–¹æ³•ã€‚

##### Array.from

å°†å¯è¿­ä»£å¯¹è±¡è½¬åŒ–å‡ºçœŸæ­£çš„æ•°ç»„

```js
let str = "Hello";

// Array.from å°†å¯è¿­ä»£å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„
alert(Array.from(str)); // H,e,l,l,o
```

##### å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªæ•°ç»„ä¸­çš„å†…å®¹ç›¸åŒï¼Ÿ

```js
JSON.stringify(arr1) === JSON.stringify(arr2);
```

##### æ‰©å±•è¿ç®—ç¬¦æ³¨æ„ç‚¹

```js
let a = [1,2,3]
let b = [...a]
// å¦‚æœåªæœ‰ä¸€å±‚ï¼Œç¡®å®æ˜¯æ·±æ‹·è´
let a = [1,2,{name:"å¼ ä¸‰"}]
let b = [...a]
ç¬¬ä¸€å±‚ç¡®å®æ˜¯æ·±æ‹·è´äº†ï¼Œç¬¬äºŒå±‚æ²¡æœ‰
```

##### js çš„é¢„è§£ææœºåˆ¶

1. var å’Œå‡½æ•°éƒ½ä¼šè¢«é¢„è§£æï¼ˆå³å˜é‡æå‡å’Œå‡½æ•°æå‡ï¼‰
2. å˜é‡**å£°æ˜ä¼šè¢«æå‡ï¼Œä½†æ˜¯èµ‹å€¼ä¸ä¼šã€‚**å‡½æ•°åˆ™æ˜¯æ•´ä¸ªéƒ½æå‡äº†ï¼Œæ¯”è¾ƒå‡½æ•°å¯æ²¡æœ‰èµ‹å€¼çš„ç­‰äºå·

```js
var a = 1;
function a() {
  console.log(1);
}
console.log(a); // 1
```

##### var æ³¨æ„äº‹é¡¹

å…¨å±€ä½œç”¨åŸŸä¸‹ var å£°æ˜çš„å˜é‡æˆ–è€…ç›´æ¥ a=1 çš„å˜é‡ï¼Œä¼šè¢«æŒ‚è½½åˆ° window ä¸Šé¢

##### å‡½æ•°ä½œç”¨åŸŸ this æŒ‡å‘çš„é—®é¢˜

å‡½æ•°å†…çš„ this æ˜¯è°è°ƒç”¨å®ƒå°±æ˜¯è°

##### llFE å½¢æˆçš„å—çº§ä½œç”¨åŸŸ(ä¸æ¨èä½¿ç”¨)

ä¹Ÿå«ç«‹å³è°ƒç”¨å‡½æ•°

```js
(function () {
  console.log("å“ˆå“ˆå“ˆå“ˆ");
})()(
  // è¿™é‡Œå¯ä»¥ä¼ å‚æ•°
  function (i) {
    console.log("å“ˆå“ˆå“ˆå“ˆ");
  }
)(i);
```

##### å…¨å±€å¯¹è±¡

åœ¨æµè§ˆå™¨ä¸­ï¼Œä½¿ç”¨ var å£°æ˜çš„å…¨å±€å‡½æ•°å’Œå…¨å±€å˜é‡ä¼šæˆä¸ºå…¨å±€å¯¹è±¡çš„å±æ€§ã€‚

ï¼ˆæ³¨æ„ï¼šfunction å£°æ˜çš„å‡½æ•°ä¹Ÿä¼šæŒ‚è½½åˆ°å…¨å±€å¯¹è±¡ä¸Šï¼‰

##### å‡½æ•°å¯¹è±¡

æ¯ä¸ªå‡½æ•°å…¶å®éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡

###### å†…å»ºå±æ€§ nameï¼ˆå®ƒè¿”å›çš„æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„å‡½æ•°åï¼‰

```js
function test() {}
let test = function () {};
console.log(test.name); // test æ¯ä¸ªå‡½æ•°å…¶å®éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡ä¸‹é¢æœ‰ä¸ªnameå±æ€§ï¼Œå…¶å®å°±æ˜¯å‡½æ•°åï¼ˆæ³¨æ„ï¼š åå­—æ˜¯stringç±»å‹ï¼‰
```

ä½†æœ‰æ—¶ï¼Œä¹Ÿä¼šå‡ºç°å¼•æ“æ— æ³•æ¨æµ‹åå­—çš„æƒ…å†µ

```js
// å‡½æ•°æ˜¯åœ¨æ•°ç»„ä¸­åˆ›å»ºçš„
let arr = [function () {}];

alert(arr[0].name); // <ç©ºå­—ç¬¦ä¸²>
// å¼•æ“æ— æ³•è®¾ç½®æ­£ç¡®çš„åå­—ï¼Œæ‰€ä»¥æ²¡æœ‰å€¼
```

###### å†…å»ºå±æ€§ lengthï¼ˆå®ƒè¿”å›å‡½æ•°å…¥å‚çš„ä¸ªæ•°ï¼‰

```js
function f1(a) {}
function f2(a, b) {}
function many(a, b, ...more) {}

alert(f1.length); // 1
alert(f2.length); // 2
alert(many.length); // 2
```

**pointer-events**

pointer-events å±æ€§æ˜¯ä¸€ä¸ªæŒ‡é’ˆå±æ€§ï¼Œæ˜¯ç”¨äºæ§åˆ¶åœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹ç‰¹å®šçš„å›¾å½¢å…ƒç´ å¯ä»¥æˆä¸ºæŒ‡é’ˆäº‹ä»¶çš„ç›®æ ‡ã€‚pointer-events å±æ€§æœ‰å¾ˆå¤šå€¼ï¼Œä½†æ˜¯å¯¹äºæµè§ˆå™¨æ¥è¯´ï¼Œé€‚ç”¨äº **HTML** å…ƒç´ çš„åªæœ‰ä¸‰ä¸ªå€¼ï¼Œå…¶å®ƒçš„å‡ ä¸ªå€¼éƒ½æ˜¯é’ˆå¯¹ **SVG** å…ƒç´ çš„

```js
1. noneï¼šè¯¥å…ƒç´ æ°¸è¿œä¸ä¼šæˆä¸ºé¼ æ ‡äº‹ä»¶çš„ targetã€‚ä½†æ˜¯ï¼Œå½“å…¶åä»£å…ƒç´ çš„ pointer-events å±æ€§æŒ‡å®šå…¶ä»–å€¼æ—¶ï¼Œé¼ æ ‡äº‹ä»¶å¯ä»¥æŒ‡å‘åä»£å…ƒç´ ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé¼ æ ‡äº‹ä»¶å°†åœ¨æ•è·æˆ–å†’æ³¡é˜¶æ®µè§¦å‘çˆ¶å…ƒç´ çš„äº‹ä»¶ä¾¦å¬å™¨ (é¼ æ ‡çš„åŠ¨ä½œå°†ä¸èƒ½è¢«è¯¥å…ƒç´ åŠå…¶å­å…ƒç´ æ‰€æ•è·ï¼Œä½†æ˜¯èƒ½å¤Ÿè¢«å…¶çˆ¶å…ƒç´ æ‰€æ•è·)ã€‚
2. autoï¼šé»˜è®¤å€¼ï¼Œè¡¨ç¤ºæŒ‡é’ˆäº‹ä»¶å·²å¯ç”¨ï¼›æ­¤æ—¶å…ƒç´ ä¼šå“åº”æŒ‡é’ˆäº‹ä»¶ï¼Œé˜»æ­¢è¿™äº›äº‹ä»¶åœ¨å…¶ä¸‹é¢çš„å…ƒç´ ä¸Šè§¦å‘ã€‚å¯¹äº SVG å†…å®¹ï¼Œè¯¥å€¼ä¸ visiblePainted æ•ˆæœç›¸åŒã€‚
3. inheritï¼šå°†ä½¿ç”¨ pointer-events å…ƒç´ çš„çˆ¶çº§çš„å€¼ã€‚
```

##### è‡ªå®šä¹‰å±æ€§

```js
function sayHi() {
  alert("Hi");

  // è®¡ç®—è°ƒç”¨æ¬¡æ•°
  sayHi.counter++;
}
sayHi.counter = 0; // åˆå§‹å€¼

sayHi(); // Hi
sayHi(); // Hi

alert(`Called ${sayHi.counter} times`); // Called 2 times
/*
è¢«èµ‹å€¼ç»™å‡½æ•°çš„å±æ€§ï¼Œæ¯”å¦‚ sayHi.counter = 0ï¼Œä¸ä¼š åœ¨å‡½æ•°å†…å®šä¹‰ä¸€ä¸ªå±€éƒ¨å˜é‡ counterã€‚æ¢å¥è¯è¯´ï¼Œå±æ€§ counter å’Œå˜é‡ let counter æ˜¯æ¯«ä¸ç›¸å…³çš„ä¸¤ä¸ªä¸œè¥¿ã€‚
æˆ‘ä»¬å¯ä»¥æŠŠå‡½æ•°å½“ä½œå¯¹è±¡ï¼Œåœ¨å®ƒé‡Œé¢å­˜å‚¨å±æ€§ï¼Œä½†æ˜¯è¿™å¯¹å®ƒçš„æ‰§è¡Œæ²¡æœ‰ä»»ä½•å½±å“ã€‚å˜é‡ä¸æ˜¯å‡½æ•°å±æ€§ï¼Œåä¹‹äº¦ç„¶ã€‚å®ƒä»¬ä¹‹é—´æ˜¯å¹³è¡Œçš„ã€‚
*/
```

##### å‘½åå‡½æ•°è¡¨è¾¾å¼

```js
/*
å…³äºåå­— func æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„åœ°æ–¹ï¼Œè¿™å°±æ˜¯æ·»åŠ å®ƒçš„åŸå› ï¼š

å®ƒå…è®¸å‡½æ•°åœ¨å†…éƒ¨å¼•ç”¨è‡ªå·±ã€‚
å®ƒåœ¨å‡½æ•°å¤–æ˜¯ä¸å¯è§çš„ã€‚

æ·»åŠ funcçš„å¥½å¤„æ˜¯ï¼šé˜²æ­¢sayHiè¢«å¤–éƒ¨ä»£ç æ”¹å˜ æˆ–è€… å‡ºç°å˜é‡é‡åçš„æƒ…å†µå¯¼è‡´sayHi æ— æ³•æ­£å¸¸å·¥ä½œ
*/
let sayHi = function func(who) {
  if (who) {
    alert(`Hello, ${who}`);
  } else {
    func("Guest"); // ä½¿ç”¨ func å†æ¬¡è°ƒç”¨å‡½æ•°è‡ªèº«æˆ–è€… sayHi('test')è°ƒç”¨è‡ªèº«éƒ½å¯ä»¥
  }
};

sayHi(); // Hello, Guest

// ä½†è¿™ä¸å·¥ä½œï¼š
func(); // Error, func is not definedï¼ˆåœ¨å‡½æ•°å¤–ä¸å¯è§ï¼‰
```

##### å…³äº alert()ä¸ console.log()å¯¹äº toString çš„è‡ªè°ƒç”¨

###### **[1]alert()**

[1.1]æœ‰é˜»å¡ä½œç”¨ï¼Œä¸ç‚¹å‡»ç¡®å®šï¼Œåç»­ä»£ç æ— æ³•ç»§ç»­æ‰§è¡Œ

[1.2]alert()åªèƒ½è¾“å‡º string,å¦‚æœ alert è¾“å‡ºçš„æ˜¯å¯¹è±¡ä¼šè‡ªåŠ¨è°ƒç”¨ toString()æ–¹æ³•

â€‹ e.g. alert([1,2,3]);//'1,2,3'

[1.3]alert ä¸æ”¯æŒå¤šä¸ªå‚æ•°çš„å†™æ³•,åªèƒ½è¾“å‡ºç¬¬ä¸€ä¸ªå€¼

â€‹ e.g. alert(1,2,3);//1

###### **[2]console.log()**

[2.1]åœ¨æ‰“å°å°è¾“å‡º

[2.2]å¯ä»¥æ‰“å°ä»»ä½•ç±»å‹çš„æ•°æ® æ³¨æ„ï¼šå…¶å® console.log ä¹Ÿä¼šè‡ªåŠ¨è°ƒç”¨ toString()æ–¹æ³•

â€‹ e.g. console.log([1,2,3]);//[1,2,3]

[2.3]æ”¯æŒå¤šä¸ªå‚æ•°çš„å†™æ³•

â€‹ e.g. console.log(1,2,3)// 1 2 3

##### â€œ new Function â€è¯­æ³•

é€šè¿‡å­—ç¬¦ä¸²æ¥åˆ›å»ºå‡½æ•°

```js
eg:
let sum = new Function('a', 'b', 'return a + b');
alert( sum(1, 2) ); // 3

eg:
let sayHi = new Function('alert("Hello")');
sayHi(); // Hello

// ä½¿ç”¨åœºæ™¯ï¼š
let str = ... åŠ¨æ€åœ°æ¥æ”¶æ¥è‡ªæœåŠ¡å™¨çš„ä»£ç  ...
let func = new Function(str);
func();

```

æ³¨æ„ï¼š new Function æ‰€å£°æ˜çš„å‡½æ•°å…¶ this æŒ‡å‘å…¨å±€ç¯å¢ƒï¼Œå¹¶**ä¸æŒ‡å‘**å½“å‰çš„è¯æ³•ç¯å¢ƒ

```js
function getFunc() {
  let value = "test";

  let func = new Function("alert(value)");

  return func;
}

getFunc()(); // error: value is not defined   æ— æ³•è®¿é—®åˆ°å½“å‰è¯æ³•ä½œç”¨åŸŸçš„å±€éƒ¨å˜é‡

// ä½†æ˜¯ä¸‹æ–¹è¿™æ ·æ˜¯å¯ä»¥çš„
let value = "test";
let func = new Function("alert(value)");
// å¯ä»¥è®¿é—®åˆ°å…¨å±€ç¯å¢ƒä¸‹å®šä¹‰çš„å…¨å±€å˜é‡
```

##### è°ƒåº¦ï¼šsetTimeout å’Œ setInterval

###### **åµŒå¥—çš„ `setTimeout` ç›¸è¾ƒäº `setInterval` èƒ½å¤Ÿæ›´ç²¾ç¡®åœ°è®¾ç½®ä¸¤æ¬¡æ‰§è¡Œä¹‹é—´çš„å»¶æ—¶ã€‚**

setInterval

```js
eg:
let i = 1;
setInterval(function() {
  func(i++);
}, 100);

æ‰§è¡Œé—´éš”ä¸ºï¼š100æ¯«ç§’  æˆ–è€…  funcæ‰§è¡Œçš„æ—¶é—´ï¼ˆå‡ºç°çš„æƒ…å†µå°±æ˜¯ funcæ‰§è¡Œæ—¶é—´å¤§äº100æ¯«ç§’æ—¶å‡ºç°ï¼‰

åŸå› ï¼š
å› ä¸º func çš„æ‰§è¡Œæ‰€èŠ±è´¹çš„æ—¶é—´â€œæ¶ˆè€—â€äº†ä¸€éƒ¨åˆ†é—´éš”æ—¶é—´
ä¹Ÿå¯èƒ½å‡ºç°è¿™ç§æƒ…å†µï¼Œå°±æ˜¯ func çš„æ‰§è¡Œæ‰€èŠ±è´¹çš„æ—¶é—´æ¯”æˆ‘ä»¬é¢„æœŸçš„æ—¶é—´æ›´é•¿ï¼Œå¹¶ä¸”è¶…å‡ºäº† 100 æ¯«ç§’ã€‚
åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒJavaScript å¼•æ“ä¼šç­‰å¾… func æ‰§è¡Œå®Œæˆï¼Œç„¶åæ£€æŸ¥è°ƒåº¦ç¨‹åºï¼Œå¦‚æœæ—¶é—´åˆ°äº†ï¼Œåˆ™ ç«‹å³ å†æ¬¡æ‰§è¡Œå®ƒã€‚
æç«¯æƒ…å†µä¸‹ï¼Œå¦‚æœå‡½æ•°æ¯æ¬¡æ‰§è¡Œæ—¶é—´éƒ½è¶…è¿‡ delay è®¾ç½®çš„æ—¶é—´ï¼Œé‚£ä¹ˆæ¯æ¬¡è°ƒç”¨ä¹‹é—´å°†å®Œå…¨æ²¡æœ‰åœé¡¿ã€‚

```

setTimeout

```js
eg:
let i = 1;
setTimeout(function run() {
  func(i++);
  setTimeout(run, 100);
}, 100);
æ‰§è¡Œé—´éš”ä¸ºï¼šfuncæœ¬èº«æ‰§è¡Œæ—¶é—´ + 100æ¯«ç§’
```

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š**é›¶å»¶æ—¶å®é™…ä¸Šä¸ä¸ºé›¶\*\***ï¼ˆåœ¨æµè§ˆå™¨ä¸­ï¼‰\*\*

```js
eg: setTimeout(func, 0);
```

åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹ï¼ŒåµŒå¥—å®šæ—¶å™¨çš„è¿è¡Œé¢‘ç‡æ˜¯å—é™åˆ¶çš„ã€‚æ ¹æ® [HTML5 æ ‡å‡†](https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#timers) æ‰€è®²ï¼šâ€œç»è¿‡ 5 é‡åµŒå¥—å®šæ—¶å™¨ä¹‹åï¼Œæ—¶é—´é—´éš”è¢«å¼ºåˆ¶è®¾å®šä¸ºè‡³å°‘ 4 æ¯«ç§’â€ã€‚

##### å¯¹è±¡çš„å±æ€§æ ‡å¿—

```js
value - å½“å‰å±æ€§çš„å€¼
writable â€” å¦‚æœä¸º trueï¼Œåˆ™å€¼å¯ä»¥è¢«ä¿®æ”¹ï¼Œå¦åˆ™å®ƒæ˜¯åªå¯è¯»çš„ã€‚
enumerable â€” å¦‚æœä¸º trueï¼Œåˆ™ä¼šè¢«åœ¨å¾ªç¯ä¸­åˆ—å‡ºï¼Œå¦åˆ™ä¸ä¼šè¢«åˆ—å‡ºã€‚
configurable â€” å¦‚æœä¸º trueï¼Œåˆ™æ­¤å±æ€§å¯ä»¥è¢«åˆ é™¤ï¼Œè¿™äº›ç‰¹æ€§ä¹Ÿå¯ä»¥è¢«ä¿®æ”¹ï¼Œå¦åˆ™ä¸å¯ä»¥ã€‚
    *æ³¨æ„ï¼Œå½“configurableä¸ºfalseæ—¶ï¼Œä¸Šé¢ä¸‰ä¸ªå±æ€§æ ‡å¿—éƒ½ä¸èƒ½ä¿®æ”¹*
```

Object.getOwnPropertyDescriptor(obj, propertyName)å¯ä»¥æŸ¥è¯¢å¯¹è±¡çš„æŸä¸ªå±æ€§çš„/_è¯¦ç»†ä¿¡æ¯/_

**obj** éœ€è¦ä»ä¸­è·å–ä¿¡æ¯çš„å¯¹è±¡

**propertyName **å±æ€§çš„åç§°

```js
let user = {
  name: "John",
};

let descriptor = Object.getOwnPropertyDescriptor(user, "name");

alert(JSON.stringify(descriptor, null, 2));
/* å±æ€§æè¿°ç¬¦ï¼š
{
  "value": "John",
  "writable": true,
  "enumerable": true,
  "configurable": true
}
*/
```

Object.defineProperty(obj, propertyName, descriptor) å¯ä»¥è®¾ç½®å¯¹è±¡çš„æŸä¸ªå±æ€§éœ€è¦åº”ç”¨çš„æè¿°ç¬¦

**obj** , **propertyName** è¦åº”ç”¨æè¿°ç¬¦çš„å¯¹è±¡åŠå…¶å±æ€§ã€‚

**descriptor** è¦åº”ç”¨çš„å±æ€§æè¿°ç¬¦å¯¹è±¡ã€‚

```js
let user = {};

Object.defineProperty(user, "name", {
  value: "John",
});

let descriptor = Object.getOwnPropertyDescriptor(user, "name");

alert(JSON.stringify(descriptor, null, 2));
/*
{
  "value": "John",
  "writable": false,
  "enumerable": false,
  "configurable": false
}
 */
```

æ³¨æ„ï¼šåœ¨ä½¿ç”¨ Object.defineProperty æ—¶ï¼Œç¬¬ä¸‰ä¸ªå‚æ•° æè¿°ç¬¦å¯¹è±¡ã€‚ç©ºå¯¹è±¡å°±é»˜è®¤é‚£ä¸‰ä¸ª**å±æ€§æ ‡å¿—**ä¸º falseï¼Œvalue ä¸º undefined

##### å¯¹è±¡çš„è®¿é—®å™¨å±æ€§ - getter å’Œ setter

```js
let user = {
  name: "John",
  surname: "Smith",

  get fullName() {
    return `${this.name} ${this.surname}`;
  },

  set fullName(value) {
    [this.name, this.surname] = value.split(" ");
  }
}
è¿™æ ·å°±åˆ›å»ºäº†ä¸€ä¸ªå¯è¯»å¯å†™çš„å±æ€§ - fullName
å½“ä¸€ä¸ªå¯¹è±¡åªæœ‰getteræ—¶ï¼Œä¼šæŠ¥é”™
let user = {
  get fullName() {
    return `...`;
  }
};
ä½†æ˜¯è¿˜æœ‰å…¶ä»–å±æ€§æ—¶æ˜¯å¯ä»¥çš„
let user = {
  name: "John",
  surname: "Smith",

  get fullName() {
    return `${this.name} ${this.surname}`;
  }
```

å…·ä½“ç”¨æ³•: å½“ç¨‹åºå‘˜åœ¨è®¿é—®æŸä¸€å¯¹è±¡å±æ€§æ—¶ï¼Œget è´Ÿè´£è¿”å›è¯¥å±æ€§çš„å€¼ï¼Œset è´Ÿè´£è®¾ç½®è¯¥å±æ€§çš„å€¼ï¼Œå…¶ä¸­**set é’©å­å‡½æ•°**çš„**å½¢å‚**å°±æ˜¯**get é’©å­å‡½æ•°**çš„è¿”å›å€¼

```js
let user = {
  name: "John",
  surname: "Smith",
};

Object.defineProperty(user, "fullName", {
  get() {
    return `${this.name} ${this.surname}`;
  },

  set(value) {
    [this.name, this.surname] = value.split(" ");
  },
});
```

##### åŸå‹ã€åŸå‹ç»§æ‰¿ä¸åŸå‹é“¾

###### å®šä¹‰ï¼š

æ¯ä¸ªå¯¹è±¡éƒ½æœ‰åŸå‹ï¼ˆ _ proto _ ï¼‰,é»˜è®¤æ˜¯æŒ‡å‘åŸå‹å¯¹è±¡çš„ï¼ˆPrototypeï¼‰ã€‚

åŸå‹å¯¹è±¡ï¼ˆPrototypeï¼‰ä¹Ÿæœ‰åŸå‹ï¼ˆ _ proto _ ï¼‰ï¼Œå…¶å€¼ä¸ºç©º

###### ç»§æ‰¿ï¼š

```js
let animal = {
  eats: true,
};
let rabbit = {
  jumps: true,
};

rabbit.__proto__ = animal;
```

é‚£ä¹ˆï¼Œrabbit å¯¹è±¡çš„åŸå‹å°±æŒ‡å‘äº† animalï¼Œä»–ä¹Ÿå°±ç»§æ‰¿äº† animal çš„å±æ€§å’Œæ–¹æ³•

åŸå‹ç»§æ‰¿å¯ä»¥å¾ˆé•¿ï¼Œä»è€Œå½¢æˆäº†åŸå‹é“¾ã€‚

è¿™é‡Œåªæœ‰ä¸¤ä¸ªé™åˆ¶ï¼š

1. å¼•ç”¨ä¸èƒ½å½¢æˆé—­ç¯ã€‚å¦‚æœæˆ‘ä»¬è¯•å›¾ç»™ `__proto__` èµ‹å€¼ä½†ä¼šå¯¼è‡´å¼•ç”¨å½¢æˆé—­ç¯æ—¶ï¼ŒJavaScript ä¼šæŠ›å‡ºé”™è¯¯ã€‚
2. `__proto__` çš„å€¼å¯ä»¥æ˜¯å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯ `null`ã€‚è€Œå…¶ä»–çš„ç±»å‹éƒ½ä¼šè¢«å¿½ç•¥ã€‚

```js
let user = {
  name: "John",
  surname: "Smith",

  set fullName(value) {
    [this.name, this.surname] = value.split(" ");
  },

  get fullName() {
    return `${this.name} ${this.surname}`;
  },
};

let admin = {
  __proto__: user,
  isAdmin: true,
};

alert(admin.fullName); // John Smith (*)

// setter triggers!
admin.fullName = "Alice Cooper"; // (**)

alert(admin.fullName); // Alice Cooperï¼Œadmin çš„å†…å®¹è¢«ä¿®æ”¹äº†
alert(user.fullName); // John Smithï¼Œuser çš„å†…å®¹è¢«ä¿æŠ¤äº†
```

###### ç»§æ‰¿æ³¨æ„ç‚¹ï¼š

1.åŸå‹ä»…ç”¨äºè¯»å–å±æ€§ã€‚å¯¹äºå†™å…¥/åˆ é™¤æ“ä½œå¯ä»¥ç›´æ¥åœ¨å½“å‰å¯¹è±¡ä¸Šè¿›è¡Œï¼Œè€Œä¸ä¼šå»å½±å“ç»§æ‰¿çš„é‚£ä¸ªå¯¹è±¡ã€‚

ä¸‹é¢çš„ä¾‹å­å¥½ç†è§£

```js
let hamster = {
  stomach: [],

  eat(food) {
    this.stomach.push(food);
    // this.stomach = [food] // å¯ä»¥ä¿®å¤ï¼ŒåŸå› ï¼šå†™å…¥å’Œåˆ é™¤æ˜¯åœ¨å½“å‰å¯¹è±¡æ“ä½œï¼Œpushå¹¶æ²¡æœ‰æ”¹å˜å†…å­˜åœ°å€
  },
};

let speedy = {
  __proto__: hamster,
};

let lazy = {
  __proto__: hamster,
};

// è¿™åªä»“é¼ æ‰¾åˆ°äº†é£Ÿç‰©
speedy.eat("apple");
alert(speedy.stomach); // apple

// è¿™åªä»“é¼ ä¹Ÿæ‰¾åˆ°äº†é£Ÿç‰©ï¼Œä¸ºä»€ä¹ˆï¼Ÿè¯·ä¿®å¤å®ƒã€‚
alert(lazy.stomach); // apple
```

2.for...in ä¼šå¾ªç¯ä¹Ÿä¼šè¿­ä»£ç»§æ‰¿çš„å±æ€§

##### åŸå‹é“¾

```js
let arr = [1, 2, 3];

// å®ƒç»§æ‰¿è‡ª Array.prototypeï¼Ÿ
alert(arr.__proto__ === Array.prototype); // true

// æ¥ä¸‹æ¥ç»§æ‰¿è‡ª Object.prototypeï¼Ÿ
alert(arr.__proto__.__proto__ === Object.prototype); // true

// åŸå‹é“¾çš„é¡¶ç«¯ä¸º nullã€‚
alert(arr.__proto__.__proto__.__proto__); // null
```

ç”±æ­¤å¯è§ï¼Œå†…å»ºå¯¹è±¡ï¼ˆå†…å»ºåŸå‹ï¼‰Array`ã€`Date`ã€`Function åŠå…¶ä»–ï¼Œçš„åŸå‹å¯¹è±¡( .prototype )éƒ½æŒ‡å‘ Object.prototypeã€‚å³ï¼šä¸‡ç‰©çš†å¯¹è±¡ã€‚

##### æœ‰è¶£çš„ this æŒ‡å‘é—®é¢˜

```js
Function.prototype.defer = function (ms) {
  let f = this;
  console.log("[ this ] >", this); // fnå‡½æ•°
  return function (...args) {
    console.log("[ this ] >", this); // windowå¯¹è±¡
    setTimeout(() => f.apply(this, args), ms);
  };
};

// check it
function fn(a, b) {
  console.log("[ this ] >", this); // å¦‚æœä¸Šé¢æ²¡æœ‰apply å°±æ˜¯windowå¯¹è±¡  æœ‰äº†applyé‚£å°±æ˜¯ä¼ çš„æ˜¯ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆ
  alert(a + b);
}

fn.defer(1000)(1, 2); // 1 ç§’åæ˜¾ç¤º 3
// apply ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ•°ç»„
// call ç¬¬äºŒä¸ªå‚æ•°æ˜¯å‚æ•°1ï¼Œå‚æ•°2
// bind ç¬¬äºŒä¸ªå‚æ•°æ˜¯å‚æ•°1ï¼Œå‚æ•°2  ä½†æ˜¯è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„
```

##### å¯¹è±¡çš„ constructor

æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ constructorï¼ŒåŒ…æ‹¬åŸå‹å¯¹è±¡ã€‚å¯¹è±¡çš„ constructor æŒ‡å‘çš„æ˜¯è¯¥å®ä¾‹å¯¹è±¡çš„æ„é€ å‡½æ•°å³å°±æ˜¯è¯¥å®ä¾‹å¯¹è±¡ã€‚

ç‰¹åˆ«ä¾‹å­ï¼š

```js
function Rabbit() {}
Rabbit.prototype = {
  eats: true,
};

let rabbit = new Rabbit();

Rabbit.prototype = {
  eats: false,
};

console.log(rabbit.eats); // true
```

å› ä¸º new å…¶å®åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡å‡ºæ¥ï¼Œç„¶åå°†æ„é€ å‡½æ•° Rabbit é‡Œé¢çš„å±æ€§éƒ½èµ‹å€¼ç»™å˜é‡ rabbitï¼Œç›¸å½“äºæ·±æ‹·è´äº†ï¼Œç„¶åå†å»ä¿®æ”¹æ„é€ å‡½æ•° Rabbit çš„å€¼ï¼Œå…¶å®æ˜¯ä¸ä¼šå½±å“å˜é‡ rabbit çš„ã€‚

##### å¯¹è±¡æ·±æ‹·è´æŠ€å·§

è¿™æ ·å¯ä»¥æ¯” for in æ›´åŠ æ­£ç¡®çš„æ‹·è´å¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œå¯æšä¸¾çš„å’Œä¸å¯æšä¸¾çš„ã€‚

```js
let clone = Object.create(
  Object.getPrototypeOf(obj),
  Object.getOwnPropertyDescriptors(obj)
);
Object.getPrototypeOf() é™æ€æ–¹æ³•è¿”å›æŒ‡å®šå¯¹è±¡çš„åŸå‹
Object.getOwnPropertyDescriptors() é™æ€æ–¹æ³•è¿”å›ç»™å®šå¯¹è±¡çš„æ‰€æœ‰è‡ªæœ‰å±æ€§æè¿°ç¬¦

//  Object.createå‡½æ•°ç†è§£
let obj = Object.create(null);
// æˆ–è€…ï¼šobj = { __proto__: null }
```

##### åŸå‹èµ‹å€¼æ³¨æ„ç‚¹

`__proto__` å±æ€§å¾ˆç‰¹æ®Šï¼šå®ƒå¿…é¡»æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–è€… `null`ã€‚å­—ç¬¦ä¸²ä¸èƒ½æˆä¸ºåŸå‹ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå°†å­—ç¬¦ä¸²èµ‹å€¼ç»™ `__proto__` ä¼šè¢«å¿½ç•¥ã€‚

##### pointer-events

è¯¥å±æ€§ç”¨äºè®¾ç½® dom å…ƒç´ æ˜¯å¦å¯ä»¥æˆä¸ºç‚¹å‡»äº‹ä»¶çš„ç›®æ ‡å…ƒç´ ï¼Œä»è€Œè¾¾åˆ°è¶Šè¿‡æŸä¸ªå…ƒç´ ï¼Œå»ç‚¹å‡»ä»–ä¸‹é¢å…ƒç´ çš„æ•ˆæœã€‚

##### ç±»

1.class åˆ›å»ºçš„ç±»ä¸èƒ½ç›´æ¥å‡½æ•°ååŠ æ‹¬å·è°ƒç”¨ï¼Œå› ä¸ºåˆ›å»ºçš„å‡½æ•°å…·æœ‰ç‰¹æ®Šçš„å†…éƒ¨å±æ€§æ ‡`[[IsClassConstructor]]: true`ï¼Œç›´æ¥è°ƒç”¨ä¼šæŠ¥é”™ã€‚

2.ç±»ä¹Ÿå¯ä»¥å¦‚ä¸‹æ–¹å¼ï¼Œå‘½åè¡¨è¾¾å¼çš„æ–¹å¼åˆ›å»ºã€‚

```js
// (è§„èŒƒä¸­æ²¡æœ‰è¿™æ ·çš„æœ¯è¯­ï¼Œä½†æ˜¯å®ƒå’Œå‘½åå‡½æ•°è¡¨è¾¾å¼ç±»ä¼¼)
let User = class MyClass {
  sayHi() {
    alert(MyClass); // MyClass è¿™ä¸ªåå­—ä»…åœ¨ç±»å†…éƒ¨å¯è§
  }
};

new User().sayHi(); // æ­£å¸¸è¿è¡Œï¼Œæ˜¾ç¤º MyClass ä¸­å®šä¹‰çš„å†…å®¹

alert(MyClass); // errorï¼ŒMyClass åœ¨å¤–éƒ¨ä¸å¯è§
```

ä½†æ˜¯è¿™æ ·æ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºè¿™æ˜¯åˆ›å»ºäº†ä¸¤ä¸ªç±»ã€‚

```js
function makeClass(phrase) {
  // å£°æ˜ä¸€ä¸ªç±»å¹¶è¿”å›å®ƒ
  return class {
    sayHi() {
      alert(phrase);
    }
  };
}

// åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»
let User = makeClass("Hello");

new User().sayHi(); // Hello
```

ç±»ä¸­å¯ä»¥ç›´æ¥åˆ›å»º get/set

```js
class User {
  constructor(name) {
    // è°ƒç”¨ setter
    this.name = name;
  }

  get name() {
    return this._name;
  }

  set name(value) {
    if (value.length < 4) {
      alert("Name is too short.");
      return;
    }
    this._name = value;
  }
}

let user = new User("John");
alert(user.name); // John

user = new User(""); // Name is too short.
```

æ³¨æ„ ï¼šç®­å¤´å‡½æ•°çš„ thisï¼Œæ˜¯è¿™ä¸ªå‡½æ•°å®šä¹‰æ—¶ï¼Œæ‰€åœ¨ä½œç”¨åŸŸçš„ thisï¼Œç”±æ­¤å¼•å‡ºé™æ€ä½œç”¨åŸŸå’ŒåŠ¨æ€ä½œç”¨åŸŸçš„åŒºåˆ«ã€‚

é™æ€ä½œç”¨åŸŸï¼šå‡½æ•°çš„ä½œç”¨åŸŸï¼Œåœ¨å®šä¹‰æ—¶ï¼Œå°±å·²ç»å†³å®šäº†ã€‚

åŠ¨æ€ä½œç”¨åŸŸï¼šå‡½æ•°çš„ä½œç”¨åŸŸï¼Œåœ¨è°ƒç”¨æ—¶æ‰å†³å®šã€‚

ä¾‹å­å¦‚ä¸‹ï¼š

```js
var val = 1;
function test() {
  console.log(val);
}
function bar() {
  var val = 2;
  test();
}

bar(); // é™æ€ä½œç”¨åŸŸæ‰“å°1ï¼ŒåŠ¨æ€ä½œç”¨åŸŸæ‰“å°2
```

##### ç±»çš„ç§æœ‰å’Œå—ä¿æŠ¤å±æ€§å’Œæ–¹æ³•

###### 1. å—ä¿æŠ¤ï¼ˆprotectedï¼‰çš„å±æ€§é€šå¸¸ä»¥ä¸‹åˆ’çº¿ `_` ä½œä¸ºå‰ç¼€ã€‚

###### 2. å—ä¿æŠ¤ï¼ˆprotectedï¼‰çš„å­—æ®µæ˜¯å¯ä»¥è¢«ç»§æ‰¿çš„ã€‚

###### 3. ç§æœ‰å±æ€§ï¼ˆprivateï¼‰å’Œæ–¹æ³•åº”è¯¥ä»¥ `#` å¼€å¤´ã€‚å®ƒä»¬åªåœ¨ç±»çš„å†…éƒ¨å¯è¢«è®¿é—®ã€‚

è®¿é—®è§„åˆ™ï¼šprivate æˆå‘˜åªèƒ½è¢«æœ¬ç±»æˆå‘˜ï¼ˆç±»å†…ï¼‰è®¿é—®ï¼Œä¸èƒ½è¢«æ´¾ç”Ÿç±»è®¿é—®ï¼Œprotected æˆå‘˜å¯ä»¥è¢«æ´¾ç”Ÿç±»è®¿é—®ã€‚åœ¨ç±»å¤–ï¼Œä¿æŠ¤æˆå‘˜å’Œç§æœ‰æˆå‘˜éƒ½ä¸èƒ½è¢«è®¿é—®ã€‚

##### Class ä¸ºæ­¤æä¾›äº† `"super"` å…³é”®å­—ã€‚

1. æ‰§è¡Œ `super.method(...)` æ¥è°ƒç”¨ä¸€ä¸ªçˆ¶ç±»æ–¹æ³•ã€‚

2. æ‰§è¡Œ `super(...)` æ¥è°ƒç”¨ä¸€ä¸ªçˆ¶ç±» constructorï¼ˆåªèƒ½åœ¨æˆ‘ä»¬çš„ constructor ä¸­ï¼‰ã€‚

æ³¨æ„ï¼šsuper ç‚¹æ–¹æ³•å¯ä»¥åœ¨å­çº§ä¸­ä»»æ„ä½ç½®ä½¿ç”¨ï¼Œä½†æ˜¯ super()è¿™æ ·å½“åˆä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œåˆ™åªèƒ½åœ¨å­çº§çš„ constructorï¼ˆæ„é€ å™¨å‡½æ•°ï¼‰ä¸­è°ƒç”¨ã€‚

##### ç»§æ‰¿ç±»çš„ constructor å¿…é¡»è°ƒç”¨ `super(...)`ï¼Œå¹¶ä¸” (!) ä¸€å®šè¦åœ¨ä½¿ç”¨ `this` ä¹‹å‰è°ƒç”¨ã€‚

1. è¦ä¹ˆå­çº§ä¸å†™ constructor å‡½æ•°ã€‚
2. ä½†æ˜¯åªæœ‰å†™äº† constructorï¼Œå°±å¿…é¡»å…ˆè°ƒç”¨ super()ï¼ˆå³å…ˆè°ƒç”¨çˆ¶çº§çš„æ„é€ å™¨å‡½æ•°ï¼‰ï¼Œè€Œä¸”æ­¤è¡Œä»£ç è¿˜å¿…é¡»å†™åˆ° this ä¹‹å‰ã€‚

```js
class a {
  constructor() {
    this.name = "å¼ ä¸‰";
  }
}
class b extends a {
  constructor(name) {
    // è¦ä¹ˆå°±æ•´ä¸ªå­çº§éƒ½ä¸å†™ï¼Œå†™äº†å°±å¿…é¡»å…ˆå†™spuer
    super("ä¼ ä»€ä¹ˆéƒ½è¡Œï¼Œä½†æ˜¯æ²¡æœ‰æˆ‘è¿™è¡Œä»£ç ä¼šæŠ¥é”™");
    this.name = name;
  }
  getName() {
    console.log(this.name);
  }
}

let c = new b("æå››");
c.getName();
```

```js
class Animal {
  constructor(name) {
    this.speed = 0;
    this.name = name;
  }
  // ...
}

class Rabbit extends Animal {
  constructor(name, earLength) {
    this.speed = 0;
    this.name = name;
    this.earLength = earLength;
  }

  // ...
}

// ä¸å·¥ä½œï¼
let rabbit = new Rabbit("White Rabbit", 10); // Error: this is not defined.
```

##### super åªåœ¨ç»§æ‰¿ç±»ï¼ˆä¹Ÿå°±æ˜¯å­çº§ï¼‰çš„å„ä¸ªå‡½æ•°ç¬¬ä¸€çº§ä½œç”¨åŸŸä¸‹æ‰æœ‰ç”¨

```js
class Rabbit extends Animal {
  stop() {
    setTimeout(() => super.stop(), 1000); // æ­£å¸¸è¿è¡Œ
  }
}
class Rabbit extends Animal {
  stop() {
    super.stop(); // æ­£å¸¸è¿è¡Œ
  }
}
class Rabbit extends Animal {
  stop() {
    (function () {
      super.stop(); // æŠ¥é”™  å› ä¸ºè¿™é‡Œçš„superè·Ÿ  å‡½æ•°stopä¸­çš„superä¸ä¸€æ ·
    })();
  }
}
```

##### ç±»çš„æ„é€ å™¨å‡½æ•°

1. ç±»éƒ½ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„æ„é€ å™¨å‡½æ•°ï¼ˆconstructorï¼‰ã€‚

2. å­çº§ç»§æ‰¿çš„çˆ¶çº§ä¹‹åï¼Œå¦‚æœå­çº§æ²¡æœ‰è‡ªå·±çš„æ„é€ å™¨å‡½æ•°ï¼ˆconstructorï¼‰ï¼Œä¼šåœ¨è°ƒç”¨å­çº§çš„æ—¶å€™å»æ‰§è¡Œçˆ¶çº§çš„æ„é€ å™¨å‡½æ•°ï¼ˆconstructorï¼‰ã€‚

##### ç±»çš„åˆå§‹åŒ–é¡ºåº

- å¯¹äºåŸºç±»ï¼ˆä¹Ÿå°±æ˜¯å¸¸è¯´çš„çˆ¶çº§ï¼‰ï¼ˆè¿˜æœªç»§æ‰¿ä»»ä½•ä¸œè¥¿çš„é‚£ç§ï¼‰ï¼Œåœ¨æ„é€ å‡½æ•°è°ƒç”¨å‰åˆå§‹åŒ–ã€‚
- å¯¹äºæ´¾ç”Ÿç±»ï¼ˆä¹Ÿå°±æ˜¯å¸¸è¯´çš„å­çº§ï¼‰ï¼Œåœ¨ `super()` åç«‹åˆ»åˆå§‹åŒ–ã€‚

åˆå§‹åŒ–ï¼šæŒ‡å¯¹ç±»å­—æ®µèµ‹å€¼å«åˆå§‹åŒ–ï¼ˆæš‚æ—¶è¿™ä¹ˆç†è§£ï¼‰ã€‚å°±æ˜¯å®šä¹‰äº†ä½†æ˜¯è¿˜æ²¡èµ‹å€¼ã€‚

ç»å…¸æ¡ˆä¾‹ï¼š

```js
class Animal {
  name = "animal";

  constructor() {
    alert(this.name); // (*)
  }
}

class Rabbit extends Animal {
  name = "rabbit";
}

new Animal(); // animal
new Rabbit(); // animal
```

```js
class Animal {
  showName() {
    // è€Œä¸æ˜¯ this.name = 'animal'
    alert("animal");
  }

  constructor() {
    this.showName(); // è€Œä¸æ˜¯ alert(this.name);
  }
}

class Rabbit extends Animal {
  showName() {
    alert("rabbit");
  }
}

new Animal(); // animal
new Rabbit(); // rabbit
```

æ³¨æ„ï¼šç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ this å’Œ superï¼Œæ‰€ä»¥ä»–ä»¬èƒ½å¤Ÿèå…¥åˆ°å°±è¿‘çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå°±åƒé€æ˜ä¼¼çš„ã€‚

##### vue2/3 åŒå‘ç»‘å®šåŸç†ç®€å•å®ç°

```js

    <script>
      // vue2
      function defineReactive(obj, key, val) {
        Object.defineProperty(obj, key, {
          get() {
            console.log(`get ${key}:${val}`);
            return val;
          },
          set(newVal) {
            if (newVal !== val) {
              val = newVal;
              console.log(this, "set", obj.foo);
            }
          },
        });
      }
      const obj = {};
      defineReactive(obj, "foo", "");
      setTimeout(() => {
        obj.foo = new Date().toLocaleTimeString(); // è¿™ä¸€æ­¥ä¼šè§¦å‘set
      }, 1000);

      // vue3
      function reactive(obj) {
        if (typeof obj !== "object" && obj != null) {
          return obj;
        }
        // Proxyç›¸å½“äºåœ¨å¯¹è±¡å¤–å±‚åŠ æ‹¦æˆª
        const observed = new Proxy(obj, {
          get(target, key, receiver) {
            const res = Reflect.get(target, key, receiver);
            console.log(`è·å–${key}:${res}`);
            return isObject(res) ? reactive(res) : res; // è¿™é‡Œå°±æ˜¯æ·±å±‚æ¬¡ç»‘å®šçš„åŸå› ï¼Œgetæ”¶é›†ä¾èµ–èƒ½å¤Ÿå±‚å±‚å¾€é‡Œé¢è¿›çš„åŸå› 
          },
          set(target, key, value, receiver) {
            const res = Reflect.set(target, key, value, receiver);
            console.log(`è®¾ç½®${key}:${value}`);
            return res;
          },
          deleteProperty(target, key) {
            const res = Reflect.deleteProperty(target, key);
            console.log(`åˆ é™¤${key}:${res}`);
            return res;
          },
        });
        return observed;
      }
      const state = reactive({
        foo: "foo",
      });
      // 1.è·å–
      state.foo; // ok
      // 2.è®¾ç½®å·²å­˜åœ¨å±æ€§
      state.foo = "fooooooo"; // ok
      // 3.è®¾ç½®ä¸å­˜åœ¨å±æ€§
      state.dong = "dong"; // ok
      // 4.åˆ é™¤å±æ€§
      delete state.dong; // ok
    </script>

```
