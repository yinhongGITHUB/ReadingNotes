#### 渲染顺序

同一组件：script → template → style
父组件 A 里面有两个子组件 B C， B 组件在 C 组件的上面
创建顺序（setup/created）：A → B → C
挂载顺序（mounted）：B → C → A
卸载顺序（unmounted）：C → B → A
父组件销毁时，会先销毁所有子组件，再销毁自己。
而对于同一层级的多个子组件（如 B、C），Vue 会按“渲染顺序的逆序”依次销毁，即先销毁后渲染的组件。

#### 从用户在地址栏输入 url 到页面展示 这中间发生了什么？

1. URL 解析：
   浏览器首先解析输入的内容，判断它是否是一个有效的 URL 或者是一个搜索查询。根据域名找到对应的 ip
2. DNS 查询：
   如果是 URL，浏览器会检查域名系统（DNS）以获取与该域名相关的 IP 地址。这一步可能涉及到缓存查找、递归 DNS 查询等。
3. 建立 TCP 连接：
   使用获得的 IP 地址，浏览器尝试通过传输控制协议（TCP）与服务器建立连接。这个过程包括三次握手（SYN, SYN-ACK, ACK）。
4. TLS 握手（如果使用 HTTPS）：
   如果网站使用 HTTPS，浏览器和服务器之间还需要进行一次安全层的握手，确保通信的安全性。这涉及证书验证、密钥交换等步骤。
5. 发送 HTTP 请求：
   一旦建立了安全连接，浏览器会发送 HTTP 请求到服务器，请求包含必要的头部信息，如请求类型（GET/POST）、路径、Cookie 等。
6. 服务器处理请求：
   服务器接收到请求后，根据请求的内容做出响应。对于静态文件，服务器直接返回文件；对于动态内容，服务器可能会运行脚本生成 HTML。
7. 接收 HTTP 响应：
   浏览器接收到服务器的响应，其中包含了状态码、头部信息和响应体。响应体通常是 HTML 文档。
8. HTML 解析：
   浏览器开始解析 HTML 文档，构建 DOM 树。在这个过程中，如果遇到外部资源（如 CSS 文件、JavaScript 文件、图片等），浏览器也会发起相应的请求下载这些资源。
9. CSSOM 构建：
   同时，浏览器还会解析 CSS 文件，构建 CSS 对象模型（CSSOM）。CSSOM 和 DOM 结合起来用于计算每个节点的样式。
10. 渲染树构建：
    将 DOM 和 CSSOM 结合起来形成渲染树，只包含需要显示在页面上的节点及其样式信息。
11. 布局 layout：
    计算每个节点在屏幕上的确切大小和位置。
12. 绘制：
    最终，浏览器将渲染树中的节点转换为屏幕上的像素，完成页面的绘制。（GPU 能够快速处理图像和视频数据的处理器）
13. JavaScript 执行：
    如果页面中有 JavaScript 脚本，它们会在适当的时机被执行，可能会修改 DOM 和 CSSOM，触发重新布局或重绘。

#### 优化 CSS 加载阻塞

**注意**：CSS 加载会阻塞页面渲染，但不会阻塞 JS 的下载，只会阻塞 JS 的执行。

1. 合并和压缩 CSS 文件：减少请求数量和文件体积，加快加载速度。
2. 使用 media 属性：为非首屏样式设置合适的 media，如 media="print" 或 media="(max-width: 600px)"，让浏览器异步加载不影响首屏渲染的 CSS。
3. 关键 CSS 内联：将首屏关键 CSS 直接写入 HTML <style> 标签，提升首屏渲染速度，其他样式异步加载。
4. 异步加载非关键 CSS：通过 JavaScript 动态插入 <link> 标签，延迟加载不影响首屏的样式。
5. 使用 preload：对重要 CSS 使用 <link rel="preload" as="style">，提前加载资源。
6. 减少 CSS 体积和复杂度：避免过多无用样式，提升解析效率。

#### 浏览器遇到 link 标签会发生什么

1. 优先判断 rel 属性，（如 stylesheet、icon、preload 等），决定要加载什么类型的资源。
2. 发起网络请求获取资源文件（rel="stylesheet"），下载对应的 css 文件（**这个过程会阻塞 DOM 渲染和 js 执行，但不会阻塞 js 下载**（因为 JS 可能会依赖样式计算结果））
3. 下载完成后，浏览器解析 CSS 内容，构建 CSSOM（CSS 对象模型）
4. 将 CSSOM 与 DOM 结合，生成渲染树，进行布局和绘制

#### link 标签的三个常见属性：crossorigin、media、rel 取值为 preload

1. crossorigin

用于控制跨域资源的请求方式（如 CSS、图片、字体等）。
常见值：
anonymous：不带凭证（cookie），只获取公开资源。
use-credentials：带凭证（cookie），可访问需要认证的资源。
影响 CORS 策略和资源能否被正确使用（如字体、图片的 canvas 操作）。

2. media

用于指定资源适用的媒体类型或条件（如屏幕宽度、打印等）。

```js
media = "screen and (max-width: 600px)"; //只在屏幕宽度小于 600px 时加载和应用样式。
```

可实现响应式和异步加载，优化首屏渲染。

3. rel 取值为 preload

用于提前加载资源，提高关键资源的加载优先级。
例：<link rel="preload" as="style" href="main.css">
as 属性指定资源类型（如 style、script、font、image），帮助浏览器优化调度。
总结：crossorigin 控制跨域，media 控制资源应用条件，preload 提前加载关键资源。
