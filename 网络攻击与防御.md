#### xss 攻击（跨站脚本攻击）

**XSS 攻击类型与原理：**

1. 反射型 XSS：

- 攻击者构造恶意链接，用户点击后，恶意脚本被服务端“反射”到响应中并执行。
- 典型场景：搜索、跳转等接口直接把用户输入拼到页面上。
- 需要用户主动点击链接。

2. 存储型 XSS：

- 恶意脚本被存储在服务端数据库（如评论、昵称等），所有访问该页面的用户都会被攻击。
- 典型场景：论坛、留言板、用户资料等。
- 一次注入，长期生效。

3. DOM 型 XSS：

- 恶意脚本通过前端 JS 操作 DOM 注入（如 location.hash、document.write），无需服务端参与。
- 典型场景：前端直接用用户输入拼接 innerHTML、eval、document.write 等。

**XSS 攻击方式：**

- 注入恶意 JS 代码，窃取 Cookie、Session、用户信息。
- 伪造页面、钓鱼、强制跳转、传播蠕虫病毒。

**XSS 防御措施：**

1. 对所有用户输入进行严格过滤和转义（如 <、>、"、'、/ 等特殊字符）。
2. 输出内容时进行 HTML 实体编码。
3. 使用 CSP（内容安全策略）限制脚本来源。
4. 禁止内联 JS、禁止 eval、document.write 等危险操作。
5. 设置 HttpOnly Cookie，防止 JS 读取敏感信息。
6. 前后端都要做输入校验和输出转义。

#### csrf 攻击（跨站请求伪造）

**CSRF 攻击原理：**

- 攻击者诱导用户访问第三方恶意网站，利用用户已登录状态，自动向目标网站发起请求（如转账、修改资料等）。
- 由于浏览器会自动携带 Cookie，目标网站误以为是用户本人操作。

**CSRF 攻击方式：**

1. GET 请求伪造：恶意网站嵌入图片、a 标签、script 等，自动发起 GET 请求。
2. POST 请求伪造：通过隐藏表单、自动提交等方式发起 POST 请求。
3. 结合 XSS，窃取用户身份信息。

**CSRF 防御措施：**

1. 验证码（如转账、敏感操作时要求输入验证码）。
2. CSRF Token（每次请求携带唯一 Token，服务端校验）。
3. SameSite Cookie（设置 Cookie 的 SameSite 属性，限制第三方网站携带 Cookie）。
4. 用户敏感操作时要求重新登录或二次验证。
5. 对 Referer、Origin 头进行校验。
