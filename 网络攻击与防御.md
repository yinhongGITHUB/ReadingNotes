#### xss 攻击（跨站脚本攻击）

**XSS 攻击类型与原理：**

1. 反射型 XSS：

- 攻击者构造恶意链接，用户点击后，恶意脚本被服务端“反射”到响应中并执行。
- 典型场景：搜索、跳转等接口直接把用户输入拼到页面上。
- 需要用户主动点击链接。

2. 存储型 XSS：

- 恶意脚本被存储在服务端数据库（如评论、昵称等），所有访问该页面的用户都会被攻击。
- 典型场景：论坛、留言板、用户资料等。
- 一次注入，长期生效。

3. DOM 型 XSS：

- 恶意脚本通过前端 JS 操作 DOM 注入（如 location.hash、document.write），无需服务端参与。
- 典型场景：前端直接用用户输入拼接 innerHTML、eval、document.write 等。

**XSS 攻击方式：**

- 注入恶意 JS 代码，窃取 Cookie、Session、用户信息。
- 伪造页面、钓鱼、强制跳转、传播蠕虫病毒。

**XSS 防御措施：**

1. 对所有用户输入进行严格过滤和转义（如 <、>、"、'、/ 等特殊字符）。
2. 输出内容时进行 HTML 实体编码。
3. 使用 CSP（内容安全策略）限制脚本来源。
4. 禁止内联 JS、禁止 eval、document.write 等危险操作。
5. 设置 HttpOnly Cookie，防止 JS 读取敏感信息。
6. 前后端都要做输入校验和输出转义。

#### csrf 攻击（跨站请求伪造）

**CSRF 攻击原理：**

- 攻击者诱导用户访问第三方恶意网站，利用用户已登录状态，自动向目标网站发起请求（如转账、修改资料等）。
- 由于浏览器会自动携带 Cookie，目标网站误以为是用户本人操作。

**CSRF 攻击方式：**

1. GET 请求伪造：恶意网站嵌入图片、a 标签、script 等，自动发起 GET 请求。
2. POST 请求伪造：通过隐藏表单、自动提交等方式发起 POST 请求。
3. 结合 XSS，窃取用户身份信息。

**CSRF 防御措施：**

1. 验证码（如转账、敏感操作时要求输入验证码）。
2. CSRF Token（每次请求携带唯一 Token，服务端校验）。
3. SameSite Cookie（设置 Cookie 的 SameSite 属性，限制第三方网站携带 Cookie）。
4. 用户敏感操作时要求重新登录或二次验证。
5. 对 Referer、Origin 头进行校验。

#### CA 证书

1. CA 证书包括:
   证书内容（包含公钥、身份信息、用途等）
   CA 的数字签名（保证内容真实、完整）

2. 服务器把 CA 证书给浏览器

##### 浏览器如何比较 CA 证书

1. 浏览器用本地已存在的 CA 公钥“解密”数字签名，得到证书内容的哈希值。
2. 浏览器用证书内容里面的哈希算法，对证书内容做一遍哈希
3. 最后比较两个 hash 值是否一致

#### 普通中间人攻击

普通中间人攻击：

- 指攻击者插在你和服务器之间，拦截、窃听或篡改通信内容。
- 常见场景：HTTP 明文传输、公共 WiFi、局域网。
- 攻击者能：
  - 窃取账号、密码、隐私等敏感信息
  - 修改服务器返回的数据（如插入广告、木马）
- 常用手段：
  1.  ARP 欺骗
  2.  DNS 劫持
  3.  伪造 WiFi
  4.  控制路由器等。
- 只要用的是明文 HTTP，数据就容易被窃听和篡改。

防御方法：

- 使用 HTTPS 加密通信
- 避免连接不安全的 WiFi
- 使用 VPN 增强安全

#### CA 证书的中间人攻击

CA 证书的中间人攻击：

- 核心：让浏览器信任假的 CA 证书，攻击者就能伪造任意网站证书。
- 主要方式：
  1.  诱导用户安装假根证书（如木马、流氓软件、企业内网统一下发）。
  2.  篡改设备的证书信任列表，把自己的 CA 证书加进去。
- 结果：攻击者可签发任意假证书，浏览器不会警告，用户以为安全，实际数据已被中间人解密和篡改。
- 本质：不是加密算法被破解，而是信任链被破坏。

防御方法：

- 不随便安装不明来源的软件，防止被植入假根证书
- 不忽略浏览器的证书警告，遇到“证书不受信任”立刻停止访问
- 定期检查和清理设备的根证书列表，删除可疑证书
- 公共 WiFi 下尽量用 VPN
- 企业内网下，明确哪些证书是公司下发的，别带到外网用
- 使用 HSTS、证书固定（Pinning）等技术，进一步防止伪造证书
